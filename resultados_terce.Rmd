## Presentación de resultados del Tercer Estudio Regional Comparativo y Explicativo (TERCE) del Laboratorio Latinoamericano de Evaluación de la Calidad de la Educación (LLECE)

### 1. Resumen
```{r init,results="hide",echo=F, message=F, warning=F}
library(foreign)
library(scales)
library(ggplot2)
library(plyr)

source('multiplot.R')
```

Hay grandes diferencias de oportunidades para nuestra niñez en materia educativa.   El Tercer Estudio Regional Comparativo y Explicativo (Terce, 2013) está diseñado para evaluar los logros educativos de los estudiantes mediante el puntaje obtenido en preguntas sobre lectura, matemáticas y ciencias.  Este estudio muestra que las diferencias de logros entre nuestros alumnos reflejan en forma marcada sus diferencias socioeconómicas y culturales, es decir, la inequidad.    

Este documento de divulgación es principalmente un llamado a analizar los datos Terce disponibles en la página Web de Meduca y un reto a la voluntad nacional por crear un sistema educativo justo, capaz de brindar igualdad de oportunidades.   

En el Terce las escuelas particulares mostraron mejores logros que las oficiales.  De hecho muchas de nuestras escuelas oficiales muestran niveles de aprendizaje poco adecuados para la vida esperada de sus alumnos, especialmente entre las escuelas rurales oficiales. Las diferencias de logros y la estrecha relación con las condiciones de vida se pueden ver en la figura 1.1 por ejemplo. Cada punto representa el promedio de puntajes y el promedio del índice socioeconómico y cultural de los alumnos de una escuela. El tamaño del punto es proporcional al número de alumnos en la escuela. El índice se construye con base en respuestas a cuestionarios sobre las condiciones de vida de cada alumno: a mayor índice las condiciones son más cómodas.    


```{r puntaje_isecf_rd, fig.width=12, fig.height=10, echo=F, message=F, warning=F}

# load sexto grado puntajes
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6 <- rbind.fill(pm6,pl6,pc6)
p6$promedio_global <- mean(p6$puntaje_estandar, na.rm=T)
p6$sd_global <- sd(p6$puntaje_estandar, na.rm=T)

p6 <- p6[p6$country == 'PAN',]

# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Oficial","Particular")
levels(qd$ruralidad) <- c("Urbano","Rural")

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]
qf <- qf[,c("idschool","idstud","ISECF","INVOLUCF","CSOCBARF","SUPERVF","RECREAF","SERVBARF","VIOLBARF","MOTIVALF","subsgobf","padindig","madindig","DQFIT01","DQFIT25","DQFIT31","DQFIT34","DQFIT15_07","DQFIT18_02")]

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Particular') { return(0) } else if (r == 'Urbano' & d == 'Oficial') { return(1) } else if (r == 'Rural' & d == 'Particular') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_isecf_school <- aggregate(ISECF ~ idschool, qf, mean)
m <- merge(mean_school, mean_isecf_school, by=c('idschool'))

ggplot(m, aes(x=ISECF,y=puntaje_estandar,color=rd,group=1,size=totalum)) + geom_point(alpha=0.7) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + scale_size(guide=FALSE) + xlab("Índice de estatus socioeconómico y cultural promedio de los alumnos de la escuela") + ylab("Puntaje promedio de los alumnos de la escuela") + ggtitle('Logros de aprendizaje por tipo de escuela')
```

Más importante que lamentarnos por los resultados pobres que podamos observar sería enfocarnos en oportunidades de mejora. Por ejemplo, algunas escuelas oficiales rurales con bajo índice socioeconómico y cultural lograron puntajes superiores al promedio internacional del Terce, equivalente a 700 puntos, e incluso mayores que las escuelas oficiales urbanas.   Estas escuelas podrían aportarnos lecciones importantes para el resto del sistema educativo.  Este enfoque representa la aspiración de este análisis y su divulgación.   

En el contexto latinoamericano, Panamá obtiene resultados por debajo de lo esperado.  La figura 1.2 confirma la tendencia conocida de que los alumnos de países con mayor producto interno bruto (PIB) per cápita obtienen mejores puntajes en promedio. Panamá obtuvo 40 puntos menos de lo esperado para su PIB per cápita, usando como referencia la línea que representa la relación típica entre logros y PIB per cápita en la figura.   Estos resultados son consistentes con los resultados que obtuvimos en evaluaciones internacionales previas: Serce 2006, Sineca 2008 y Pisa 2009. Panamá puede y debe mejorar significativamente sus logros de aprendizaje.    


```{r puntaje_gdp, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
p6 <- rbind.fill(pm6,pl6,pc6)


gdp <- read.csv('./data/suplemental/gdp.csv')
names(gdp) <- c("Country_Name","country","gdp_2013")
m <- merge(p6,gdp,by="country")
a <- aggregate( puntaje_estandar ~ country + gdp_2013, m, mean)
ggplot(a, aes(x=gdp_2013, y=puntaje_estandar, fill=country, color=country, group=1)) + geom_point() + geom_smooth(method = "lm", se = F) + geom_text(aes(label=country)) + xlab("Producto (PIB) per cápita") + ylab("Puntaje promedio") + ggtitle("Figura 1.2. Logros de aprendizaje en 6to grado según producto (PIB) per cápita por país") + scale_x_continuous(label=dollar)

```

### 2. Introducción 


La educación nacional debe servir como un gran equalizador hacia las mejores oportunidades de bienestar para todos, que renueve en cada generación las posibilidades de realización personal y de un país próspero sostenible.  

Nuestro sistema educativo dista mucho de este ideal.   Afortunadamente es posible evaluar los logros del sistema con métodos científicos que permitan recomendaciones confiables de como mejorar.   Una cultura que valora la información puede aprender de sus propios errores.    

Evaluaciones como el Terce, basadas en pruebas estandarizadas, tienen limitaciones propias del esquema de items, o preguntas que utilizan, y están sujetas a ser perfeccionadas, pero sirven como insumos valiosos para las políticas educativas cuando son analizados en contexto y junto con información relevante apropiada.    

Esta es la segunda divulgación en torno al Terce. Este documento presenta sólo algunos de los aspectos sobresalientes, sin intentar ser exhaustivo, para lograr un documento más conciso y accesible.  Previamente en 2014, Unesco y Meduca divulgaron la comparación de resultados entre el Segundo Estudio Regional Comparativo y Explicativo (Serce, 2006) y el Terce, 2013.   

Con esta divulgación Meduca invita a todos los interesados, especialmente aquellos familiarizados con métodos de evaluación educativa, a iniciar un gran movimiento de exploración de los datos educativos disponibles, especialmente los resultados de las evaluaciones Serce 2006, Sineca 2008, Pisa 2009 y Terce 2013.   

### 3. Terce y la participación de Panamá
#### 3.1 ¿Qué es la evaluación Terce?

El Laboratorio Latinoamericano de Evaluación de la Calidad de la Educación, Llece, es una organización con sede en Chile que  diseña y administra evaluaciones a nivel regional.  Terce es la tercera evaluación.   Cada país revisa y edita los ítems o preguntas de la evaluación para asegurar que son apropiadas para el contexto propio.     

El Terce evaluó 15 países de América Latina, listados en el margen derecho de la figura 1.2, y la región de Nuevo León de México, omitida de la figura porque la información estándar del PIB utilizada sólo incluye países.  La evaluación cubrió las áreas de lectura de tercero y sexto grado, matemáticas de tercero y sexto grado, y ciencias de sexto grado.   También incluyó una nueva prueba de escritura que será sujeto de divulgación posterior.  

La muestra de alumnos y escuelas por país es representativa, aunque la muestra que elaboró Panamá no fue diseñada para comparar algunos aspectos de interés como la comparación de resultados entre provincias o comarcas, por ejemplo.  Comprendemos que en el futuro debemos ampliar los aspectos que puedan ser explorados confiablemente en las evaluaciones educativas del país.    

El Terce también incluye factores potencialmente relacionados con los logros de aprendizaje, conocidos como factores asociados. La evaluación formula preguntas a los alumnos, docentes y hogares de cada alumno sobre el entorno y situación individual para poder explorar el impacto de estos factores.    Aquí solo presentamos una selección de los factores asociados con efectos más interesantes, sin intentar profundizar en sus explicaciones o implicaciones pues esas conclusiones deben ser resultado de un debate académico riguroso más amplio. 

#### 3.2 Características de las escuelas y alumnos participantes de Panamá

`r length(unique(qd$idschool))` participaron en la prueba Terce representando cuatro tipos de escuela así:  oficial urbana `r length(unique(qd[qd$dependencia == 'Oficial' & qd$ruralidad == "Urbano",]$idschool))`, oficial rural `r length(unique(qd[qd$dependencia == 'Oficial' & qd$ruralidad == "Rural",]$idschool))`, particular urbana `r length(unique(qd[qd$dependencia == 'Particular' & qd$ruralidad == "Urbano",]$idschool))`, particular rural `r length(unique(qd[qd$dependencia == 'Particular' & qd$ruralidad == "Rural",]$idschool))`.  En el total de escuelas, 3775 estudiantes correspondían a sexto grado y 3631 estudiantes a tercer grado.


```{r demo_pub_priv, fig.width=12, fig.height=7, echo=F, message=F, warning=F}
a <- aggregate(ruralidad ~ dependencia, qd, length)
ggplot(a, aes(x=dependencia, y=ruralidad)) + geom_bar(fill='#0072B2',stat="identity",width=.5) + ylab("Cantidad de Escuelas") + ggtitle("Distribución de escuelas por sector escolar") +xlab("Sector escolar")
```

```{r demo_ruralidad, fig.width=12, fig.height=7, echo=F, message=F, warning=F}
a <- aggregate(dependencia ~ ruralidad, qd, length)
ggplot(a, aes(x=ruralidad, y=dependencia)) + geom_bar(fill='#0072B2',stat="identity",width=.5) + ylab("Cantidad de Escuelas") + ggtitle("Distribución de escuelas por ruralidad") + xlab("Ruralidad")
```
Las escuelas participantes de Panamá están principalmente concentradas en el promedio del índice socioeconómico y cultural (0.0) de toda la región latinoamericana, en cuanto el índice promedio de sus alumnos.  

```{r demo_isecf, fig.width=12, fig.height=12, echo=F, message=F, warning=F}

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
ggplot(qf[qf$country %in% c("CHL","URU","CRI","PAN","NIC"),], aes(x=ISECF)) + geom_histogram(fill='#0072B2') + ylab("Cantidad de Escuelas") + facet_grid(country ~ ., scales='free_y') + scale_y_continuous(breaks=NULL) + geom_vline(x=0, colour="red", linetype = "longdash") + ggtitle("Concentración de escuelas (distribución) según índice socioeconómico y cultural para tres países de la prueba") + xlab("Índice socioeconómico y cultural")
```
Las dos figuras siguientes muestran la cantidad de estudiantes participantes por edad en tercer grado y sexto grado.  

[JEV2IBG: supongo que la siguiente grafica es de 6to grado.  falta 3er grado? Incluirla primero]

[JEV2IBG: usar como título "Número de estudiantes de sexto grado por edad"]

```{r demo_genero_edad, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
qa6 <- read.spss('./data/Alumnos/QA6.SAV', to.data.frame=T)
qa6 <- qa6[qa6$country == 'PAN',]
qa6$DQA6IT01 <- as.factor(qa6$DQA6IT01)
qa6$DQA6IT02 <- as.factor(qa6$DQA6IT02)
levels(qa6$DQA6IT01) <- c("10 años o menos","11 años","12 años", "13 años", "14 años", "15 años o mas", "NA")
levels(qa6$DQA6IT02) <- c("Niña","Niño")

ggplot(qa6, aes(x=DQA6IT01, fill=DQA6IT02)) + geom_histogram(alpha=.5, position="dodge") + scale_x_discrete(labels=c("10 años o menos","11 años","12 años", "13 años", "14 años", "15 años o mas", "NA")) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + scale_fill_discrete(labels=c("Niña","Niño")) + ylab("Cantidad de Estudiantes") + scale_fill_discrete(guide=FALSE) + xlab("Edad") + ggtitle("Número de estudiantes de sexto grado por edad")
```

```{r edad_summary, echo=F, message=F, warning=F}
my.summary <- (summary(qa6$DQA6IT01)/sum(summary(qa6$DQA6IT01)))*100
kable(data.frame(porcentaje=my.summary))
```

[JEV2IBG: podríamos usar porcentajes en el eje Y en lugar de cantidad?]

```{r demo_genelaro, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
qa6 <- read.spss('./data/Alumnos/QA6.SAV', to.data.frame=T)
qa6 <- qa6[qa6$country == 'PAN',]
qa6$DQA6IT02 <- as.factor(qa6$DQA6IT02)
levels(qa6$DQA6IT02) <- c("Niña","Niño")

ggplot(qa6, aes(x=DQA6IT02)) + geom_histogram(fill='#0072B2',width=0.5,position="dodge")  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Cantidad de Estudiantes") + xlab("¿Eres niña o niño?") + ggtitle("Respuesta a la pertenencia de género")
```

```{r genero_summary, echo=F, message=F, warning=F}
my.summary <- (summary(qa6$DQA6IT02)/sum(summary(qa6$DQA6IT02)))*100
kable(data.frame(porcentaje=my.summary))
```
[ORGNR PORCENTAJE AFIRMATIVO]% de los alumnos indicó pertenecer a alguna etnia "originaria" y [ORGNR PORCENTAJE N/A]% no contestó o no supo responder.   

[JEV2IBG: podríamos usar porcentajes en el eje Y en lugar de cantidad?]
[JEV2IBG: agregar tílde al término "índigena" en la leyenda del eje X]

```{r etnia, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
qa6 <- read.spss('./data/Alumnos/QA6.SAV', to.data.frame=T)
qa6 <- qa6[qa6$country == 'PAN',]
qa6$DQA6IT06 <- as.factor(qa6$DQA6IT06)
levels(qa6$DQA6IT06) <- c("No","Si")

ggplot(qa6, aes(x=DQA6IT06)) + geom_histogram(fill='#0072B2',width=0.5, position="dodge")  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Cantidad de Estudiantes") + xlab("¿Perteneces a alguna etnia indígena?") + ggtitle("Respuesta a la pertenencia de etnia originaria")
```

```{r etnia_summary, echo=F, message=F, warning=F}
my.summary <- (summary(qa6$DQA6IT06)/sum(summary(qa6$DQA6IT06)))*100
kable(data.frame(porcentajes=my.summary))
```


## 4. Comparacion con America Latina
### 4.1 Puntaje vs ingreso per capita (3er grado, 6to grado)

Comparar resultados entre países es útil pero no lo principal. Es un error considerar la evaluación Terce como una competencia por el mayor puntaje promedio.   Sus resultados son sólo parte de la evidencia e información de cuánto logran aprender los alumnos.  Su valor principal está en intentar comprender qué acciones se pueden tomar para que la educación le de las mejores oportunidades de vida a los alumnos y países.   

Entre los países participantes Chile obtuvo el mejor resultado seguido de Costa Rica y México.  Costa Rica sirve de ejemplo que un país de escala y ubicación como la nuestra puede obtener mejores resultados.     Las figuras [NO. 3ero PTJ VS PIB/CAP] Y [NO. 6ero PTJ VS PIB/CAP] siguientes muestran que Panamá obtiene resulados inferiores a lo esperado para su producto interno bruto per cápita.  Estos resultados son consistentes con otras pruebas internacionales en las que ha participado Panamá (pruebas Serce 2006 y Pisa 2009). El efecto es más pronunciado para sexto grado que para tercer grado.   Parece razonable esperar que con la prioridad social necesaria, la riqueza nacional nos permita lograr al menos los resultados esperados.   

```{r puntaje_gdp_3, fig.width=12, fig.height=10, echo=F, message=F, warning=F}

pm3 <- read.spss('./data/Puntajes_Alumnos/PM3_all_TERCE.sav', to.data.frame=T)
pl3 <- read.spss('./data/Puntajes_Alumnos/PL3_all_TERCE.sav', to.data.frame=T)

pm3$tipo <- 'matematica'
pl3$tipo <- 'lectura'

p3 <- rbind.fill(pm3,pl3)
gdp <- read.csv('./data/suplemental/gdp.csv')
names(gdp) <- c("Country_Name","country","gdp_2013")
m <- merge(p3,gdp,by="country")
a <- aggregate( puntaje_estandar ~ country + gdp_2013, m, mean)
ggplot(a, aes(x=gdp_2013, y=puntaje_estandar, fill=country, color=country, group=1)) + geom_point() + geom_smooth(method = "lm", se = F) + geom_text(aes(label=country)) + xlab("Producto (PIB) per cápita") + ylab("Puntaje promedio") + ggtitle("Puntaje promedio según producto (PIB) per cápita por país, tercer grado") + scale_x_continuous(label=dollar)

```

```{r puntaje_gdp_6, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
p6 <- rbind.fill(pm6,pl6,pc6)


gdp <- read.csv('./data/suplemental/gdp.csv')
names(gdp) <- c("Country_Name","country","gdp_2013")
m <- merge(p6,gdp,by="country")
a <- aggregate( puntaje_estandar ~ country + gdp_2013, m, mean)
ggplot(a, aes(x=gdp_2013, y=puntaje_estandar, fill=country, color=country, group=1)) + geom_point() + geom_smooth(method = "lm", se = F) + geom_text(aes(label=country)) + xlab("Producto (PIB) per cápita") + ylab("Puntaje promedio") + ggtitle("Puntaje promedio según producto (PIB) per cápita por país, sexto grado") + scale_x_continuous(label=dollar)

```

### 4.2 Desempeño en logros de aprendizaje

Más relevante en primera instancia es saber si nuestros niños y niñas logran un aprendiza útil para su propio bienestar y la prosperidad de la nación. La evaluación Terce define cuatro niveles de logros de aprendizaje.  El nivel 1 se considera insuficiente preparación y el nivel 4 la mejor preparación educativa para la vida esperada de los participantes.  Corresponden a dominios progresivamente más eficaces del área de conocimiento y están explicados en el apéndice [No. APENDICE NIVELES].  

[22?]% de nuestras niñas y niños muestran un logro de aprendizaje en el nivel inferior, o nivel 1, considerado inadecuado como preparación para su vida.   Para ciencias son [45?]% y para matemáticas [65?]%.   La figura [No. NIVELES] muestra como se comparan los porcentajes de alumnos de Panamá para cada nivel con los del resto de los alumnos de otros países. 

[JEV2IBG: título "Niveles de logros de aprendizaje por área de conocimiento, comparados"]
[JEV2IBG: cambiar la leyenda del eje Y a "Porcentaje de alumnos"]
[JEV2IBG: cambiar la leyenda del eje X a "Niveles de logro de aprendizaje"]
[JEV2IBG: verificar que las leyendas del eje X y Y empiezan con mayúscula]
[JEV2IBG: eliminar del margen derecho la etiqueta "countryp"]
[JEV2IBG: si es posible, usar colores menos intensos para las barras, especialmente el rojo (asusta ;)]

```{r niveles_barcharts, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
p6 <- rbind.fill(pm6,pl6,pc6)
p6$grado <- '6'

pm3 <- read.spss('./data/Puntajes_Alumnos/PM3_all_TERCE.sav', to.data.frame=T)
pl3 <- read.spss('./data/Puntajes_Alumnos/PL3_all_TERCE.sav', to.data.frame=T)

pm3$tipo <- 'matematica'
pl3$tipo <- 'lectura'

p3 <- rbind.fill(pm3,pl3)

p3$grado <- '3'

p <- rbind.fill(p6,p3)

ispan <- function(x) { if(x == 'PAN') { return("PAN") } else { return("OTROS") } }
p$countryp <- sapply(p$country,ispan)
a <- aggregate(puntaje_estandar ~ nivel + countryp + tipo + grado, p, length)
calc_percent <- function(c,t,g,x) { return(100*(x/sum(a[a$countryp == c & a$tipo == t & a$grado == g,]$puntaje_estandar))) }
a$dist <- mapply(calc_percent, a$countryp, a$tipo, a$grado, a$puntaje_estandar)

#####
ggplot(a[a$grado == 6,], aes(x=nivel,y=dist,fill=countryp)) + geom_bar(stat="identity", position=position_dodge(), colour="black") + ggtitle("Cantidad de Estudiantes por Nivel (6to Grado)") + facet_grid(tipo ~ .) + scale_fill_brewer(palette="Spectral")
```

## 5 Características de los resultados en Panamá
### 5.1 Logros por Genero 

Las niñas obtuvieron mejores resultados que los niños en lectura de tercer grado, sexto grado y en ciencias de sexto grado. En matemáticas, aunque las niñas obtuvieron mejor resultado, la diferencia es tan pequeña que no permite afirmar que sus logros de aprendizaje son mejores.   

Las figuras [No. PTJ POR GNR] y [No. STD DEV GNR] comparan los puntajes promedio obtenidos por cada género, la primera, y la diferencia entre niños y niñas, la segunda, expresada en desviaciones estándar 

[JEV2IBG: cambiar la leyenda del eje Y a "Puntaje promedio"]
[JEV2IBG: cambiar la leyenda del eje X a "Género"] 
[JEV2IBG: eliminar del margen derecho la etiqueta "DQASIT02"] 

```{r demo_genero_puntaje, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
p6 <- p6[p6$country == 'PAN',]
qa6$DQA6IT02 <- as.factor(qa6$DQA6IT02)

genero <- merge(p6,qa6,by='idstud')
a <- aggregate(puntaje_estandar ~ DQA6IT02, genero, mean)
a$dif <- (a$puntaje_estandar - mean(p6$puntaje_estandar,na.rm=T))/sd(p6$puntaje_estandar,na.rm=T)
levels(a$DQA6IT02) <- c("Niña","Niño")
dif <- data.frame(genero=c("Niña"),std_mean=c(a$dif[1] - a$dif[2]))

ggplot(a, aes(x=DQA6IT02,y=puntaje_estandar,fill=DQA6IT02)) + geom_bar(stat='identity') + ggtitle("Puntaje promedio comparado entre géneros") + ylab("Puntaje promedio") + xlab("Género") + scale_fill_discrete(guide=F)
```
[JEV2IBG: esta gráfica debería ser una sola barra de valores positivos a favor de las niñas, indicando la diferencia entre el puntaje de niñas menos el de niños expresada en desviaciones estándar]

```{r demo_genero_puntaje_desv, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(dif, aes(x=genero,y=std_mean)) + geom_bar(stat='identity',fill="#f8766d",width=.5) + ggtitle('Diferencia diminuta de puntaje promedio a favor de las niñas') + ylab("Desviaciones estandar") + xlab("Diferencia")+ scale_fill_discrete(guide=F) + scale_y_continuous(limits=c(-0.8,0.8))
```

### 5.2 Logros de grupos originarios

Los alumnos que se reconocen como miembros de etnias originarias logran menor puntaje que los que no se consideran miembros.  Las figuras [No. PTJ POR ETN] y [No. STD DEV ETN] comparan los puntajes promedio y diferencia según si la alumna o alumno se reconoce o no como miembro de grupos originarios.    

[JEV2IBG: título "Puntaje promedio comparado según pertenencia a grupos originarios"]
[JEV2IBG: cambiar la leyenda del eje Y a "Puntaje promedio"]
[JEV2IBG: cambiar "DQA6IT06" en la leyenda del eje X por "Etnia"] 
[JEV2IBG: cambiar las etiquetas en el eje X por "No originarios" y "Originarios"]
[JEV2IBG: eliminar del margen derecho la etiqueta "DQA6IT06"] 
[JEV2IBG: como procesaste aquellos que respondieron N/A]

```{r demo_etnia_puntaje, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
qa6$DQA6IT06 <- as.factor(qa6$DQA6IT06)

genero <- merge(p6,qa6,by='idstud')
a <- aggregate(puntaje_estandar ~ DQA6IT06, genero, mean)
a$dif <- (a$puntaje_estandar - mean(p6$puntaje_estandar,na.rm=T))/sd(p6$puntaje_estandar,na.rm=T)
levels(a$DQA6IT06) <- c("No originarios","Originarios")

ggplot(a, aes(x=DQA6IT06,y=puntaje_estandar,fill=DQA6IT06)) + geom_bar(stat='identity') + ggtitle("Puntaje promedio comparado según pertenencia a grupos originarios") + ylab("Puntaje promedio") + xlab("Etnia") + scale_fill_discrete(guide=F)
```

```{r demo_etnia_puntaje_desv, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
dif <- data.frame(genero=c("Originarios"),std_mean=c(a$dif[1] - a$dif[2]))
ggplot(dif, aes(x=genero,y=std_mean)) + geom_bar(stat='identity',fill="#0072B2",width=.5) + ggtitle('Diferencia de puntaje promedio desfavorece a los grupos originarios') + ylab("Desviaciones estandar") + xlab("Diferencia")+ scale_fill_discrete(guide=F) + scale_y_continuous(limits=c(-0.8,0.8))
```
Adicionalmente, el índice socioeconómico y cultural muestra menor relación con el puntaje promedio obtenido para alumnos que se consideran miembros de grupos originarios que para aquellos que no.   Esto lo ilustra la figura [No. PTJ VS ISECF ORGN] en la que cada línea muestra la correspondencia entre puntaje promedio obtenido y el índice del alúmno.  La diferencia de puntaje entre alumnos de menor y mayor índices es más pronunciada para alumnos que se declaran no originarios.  

[JEV2IBG: título "Relación entre logros e índice socioeconómico y cultural según etnia"]
[JEV2IBG: cambiar la leyenda del eje Y a "Puntaje promedio"]
[JEV2IBG: cambiar la leyenda del eje X a "Índice socioeconómico y cultural"] 
[JEV2IBG: eliminar del margen derecho la etiqueta "DQA6IT06"] 

```{r demo_etnia_puntaje_isecf, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
# load factores familia

qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]
qf <- qf[,c("idstud","ISECF")]

g <- merge(genero,qf,by='idstud')

levels(g$DQA6IT06) <- c("No Indigena","Etnia Indigena")
ggplot(g[!is.na(g$DQA6IT06),], aes(x=ISECF,y=puntaje_estandar,color=DQA6IT06)) + geom_point(alpha=0.0) + geom_smooth(method = "lm", se = F) + ggtitle("Relación entre logros e índice socioeconómico y cultural según etnia") + xlab("Índice socioeconómico y cultural") + ylab("Puntaje promedio") + scale_color_discrete(guide=F)
```
### 5.3 Logros según tipo de escuela

Las oportunidades de educación y salud muestran un altísimo grado de influencia en el bienestar de un individuo. Cuándo los logros de aprendizaje dependen marcadamente del poder adquisitivo de una persona es difícil argumentar que la sociedad brinda oportunidades justas a todos sus residentes.  En Panamá, la diferencia de logros entre escuelas particulares, escuelas oficiales urbanas y escuelas oficiales rurales es muy marcada.   

Las figuras [No. PTJ VS ISEC 3ero] y [No. PTJ VS ISEC 6to] muestran para cada escuela participante de Panamá el puntaje promedio obtenido por sus alumnos en el eje vertical y el índice socioeconómico y cultural promedio de sus alumnos en el eje horizontal. Las líneas representan el puntaje promedio de alumnos de todos los países, incluyendo Panamá, en la prueba Terce y el puntaje debajo del cual se define el nivel 1 de aprendizaje, considerado inadecuado para las situaciones de vida esperadas. [PORCENTAJE NIVEL 1]% de las niñas y niños obtuvieron puntajes correspondientes al nivel 1.   

```{r puntaje_isecf_rd_3, fig.width=12, fig.height=10, echo=F, message=F, warning=F}

# load sexto grado puntajes
pm3 <- read.spss('./data/Puntajes_Alumnos/PM3_all_TERCE.sav', to.data.frame=T)
pl3 <- read.spss('./data/Puntajes_Alumnos/PL3_all_TERCE.sav', to.data.frame=T)

pm3 <- pm3[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl3 <- pl3[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm3$tipo <- 'matematica'
pl3$tipo <- 'lectura'
p3 <- rbind.fill(pm3,pl3)

p3 <- p3[p3$country == 'PAN',]

# load factores alumnos
qd <- read.spss('./data/Directores/QD3.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Oficial","Particular")
levels(qd$ruralidad) <- c("Urbano","Rural")

# load factores familia
qf <- read.spss('./data/Familia/QF3.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]
qf <- qf[,c("idschool","idstud","ISECF","INVOLUCF","CSOCBARF","SUPERVF","RECREAF","SERVBARF","VIOLBARF","MOTIVALF","subsgobf","padindig","madindig","DQFIT01","DQFIT25","DQFIT31","DQFIT34","DQFIT15_07","DQFIT18_02")]

pe <- merge(p3,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Particular') { return(0) } else if (r == 'Urbano' & d == 'Oficial') { return(1) } else if (r == 'Rural' & d == 'Particular') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_isecf_school <- aggregate(ISECF ~ idschool, qf, mean)
m <- merge(mean_school, mean_isecf_school, by=c('idschool'))

ggplot(m, aes(x=ISECF,y=puntaje_estandar,color=rd,group=1,size=totalum)) + geom_point(alpha=0.7) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + scale_size(guide=FALSE) + xlab("Índice de estatus socioeconómico y cultural promedio de los alumnos de la escuela") + ylab("Puntaje promedio de los alumnos de la escuela") + ggtitle('Logros de aprendizaje por tipo de escuela')
```

[JEV2IBG: las 2 figuras aqui son las versiones de 3ero y 6to grado de la figura 1 en el resumen ejecutivo]
[JEV2IBG: Pregunta: las figuras de puntaje vs isec por escuela pueden indcar un solo puntaje para definir el nivel 1 de todas las áreas de conocimiento, o el puntaje que define el nivel 1 cambia de área a área]

Una observación de suma importancia es que hay un grupo de escuelas oficiales rurales cuyos logros promedio son iguales o superiores a los de las escuelas oficiales urbanas a pesar de tener índices socioeconómicos y culturales menores en promedio. Estas escuelas probablemente tienen lecciones que aportar en cuanto a cómo mejorar los logros educativos en las áreas menos favorecidas del país.    

[JEV2IBG: titulo "logros de aprendizaje de escuelas particulares y oficiales, urbanas y rurales, tercer grado]
[JEV2IBG: cambiar la leyenda del eje Y a "Puntaje promedio"]
[JEV2IBG: cambiar la leyenda del eje X a "Índice socioeconómico y cultural"]
[JEV2IBG: intentar incluir los niveles de aprendizaje, o al menos el nivel 1]

[JEV2IBG: titulo "logros de aprendizaje de escuelas particulares y oficiales, urbanas y rurales, sexto grado]
[JEV2IBG: cambiar la leyenda del eje Y a "Puntaje promedio"]
[JEV2IBG: cambiar la leyenda del eje X a "Índice socioeconómico y cultural"]
[JEV2IBG: intentar incluir los niveles de aprendizaje, o al menos el nivel 1]

## 6 Relacion entre desempeño y factores típicamente asociados al proceso de aprendizaje
## 6.1 ¿Qué son factores asociados?

Son características o circumstancias cuantificables que podrían mostrar relación con los logros de aprendizaje.  El que muestren relación no significa por si solo que sea garantía ni causa de los logros, pero sugiere que es conveniente explorar la relación.   

## 6.2 Logros según factores asociados a la escuela

[JEV2IBG: esta grafica la podemos suprimir porque la siguiente cuenta la misma historia en más detalle]

```{r puntaje_INFRAD, fig.width=12, fig.height=10, echo=F, message=F, warning=F}

# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Oficial","Particular")
levels(qd$ruralidad) <- c("Urbano","Rural")

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]
qf <- qf[,c("idschool","idstud","ISECF","INVOLUCF","CSOCBARF","SUPERVF","RECREAF","SERVBARF","VIOLBARF","MOTIVALF","subsgobf","padindig","madindig","DQFIT01","DQFIT25","DQFIT31","DQFIT34","DQFIT15_07","DQFIT18_02")]

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Particular') { return(0) } else if (r == 'Urbano' & d == 'Oficial') { return(1) } else if (r == 'Rural' & d == 'Particular') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_infrad_school <- aggregate(INFRAD ~ idschool, qd, mean)
m <- merge(mean_school, mean_infrad_school, by=c('idschool'))

ggplot(m, aes(x=INFRAD,y=puntaje_estandar,color=rd,group=1)) + geom_point(alpha=0.7) + geom_smooth(method = "lm", se = F) + scale_size(guide=FALSE) + xlab("Índice de infraestructura de la escuela") + ylab("Puntaje Promedio por Escuela")
```
Los logros de aprendizaje, evaluados a través de los puntajes Terce, muestran una relación clara con La infraestructura de la escuela.  Esto por si solo no permite concluir que una mejor infraestructura genera mejores logros; por ejemplo, una mejor situación socioeconómica y cultural da la oportunidad de asistir a una mejor escuela tanto en infraestructura como en eficacia, sin que sea claro cual es el factor principal que logra esa eficacia. Comprender la relación entre infraestructura y logros requiere mayor análisis para determinar hasta que punto la infraestructura influye en los logros. 


```{r puntaje_VIOLEND, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Oficial","Particular")
levels(qd$ruralidad) <- c("Urbano","Rural")

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]
qf <- qf[,c("idschool","idstud","ISECF","INVOLUCF","CSOCBARF","SUPERVF","RECREAF","SERVBARF","VIOLBARF","MOTIVALF","subsgobf","padindig","madindig","DQFIT01","DQFIT25","DQFIT31","DQFIT34","DQFIT15_07","DQFIT18_02")]

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Particular') { return(0) } else if (r == 'Urbano' & d == 'Oficial') { return(1) } else if (r == 'Rural' & d == 'Particular') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_infrad_school <- aggregate(VIOLEND ~ idschool, qd, mean)
m <- merge(mean_school, mean_infrad_school, by=c('idschool'))

ggplot(m, aes(x=VIOLEND,y=puntaje_estandar,color=rd,group=1)) + geom_point(alpha=0.7) + geom_smooth(method = "lm",  se = F) + scale_size(guide=FALSE) + xlab("Índice de violencia en el entorno de la escuela") + ylab("Puntaje Promedio por Escuela")
```
La figura siguiente ilustra que no se ve una relación clara entre la violencia del entorno escolar y los logros de aprendizaje.   

```{r puntaje_CSOCIALD, fig.width=12, fig.height=10, echo=F, message=F, warning=F}

# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Oficial","Particular")
levels(qd$ruralidad) <- c("Urbano","Rural")

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]
qf <- qf[,c("idschool","idstud","ISECF","INVOLUCF","CSOCBARF","SUPERVF","RECREAF","SERVBARF","VIOLBARF","MOTIVALF","subsgobf","padindig","madindig","DQFIT01","DQFIT25","DQFIT31","DQFIT34","DQFIT15_07","DQFIT18_02")]

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Particular') { return(0) } else if (r == 'Urbano' & d == 'Oficial') { return(1) } else if (r == 'Rural' & d == 'Particular') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_infrad_school <- aggregate(CSOCIALD ~ idschool, qd, mean)
m <- merge(mean_school, mean_infrad_school, by=c('idschool'))

ggplot(m, aes(x=CSOCIALD,y=puntaje_estandar,color=rd,group=1)) + geom_point(alpha=0.7) + geom_smooth(method = "lm",  se = F) + scale_size(guide=FALSE) + xlab("Índice del capital social en el entorno de la escuela") + ylab("Puntaje Promedio por Escuela")
```
Tampoco se ve una relación clara entre el capital social en el entorno escolar y los logros de aprendizaje. 

```{r puntaje_AUTOADD, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Oficial","Particular")
levels(qd$ruralidad) <- c("Urbano","Rural")

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]
qf <- qf[,c("idschool","idstud","ISECF","INVOLUCF","CSOCBARF","SUPERVF","RECREAF","SERVBARF","VIOLBARF","MOTIVALF","subsgobf","padindig","madindig","DQFIT01","DQFIT25","DQFIT31","DQFIT34","DQFIT15_07","DQFIT18_02")]

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Particular') { return(0) } else if (r == 'Urbano' & d == 'Oficial') { return(1) } else if (r == 'Rural' & d == 'Particular') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_infrad_school <- aggregate(AUTOADD ~ idschool, qd, mean)
m <- merge(mean_school, mean_infrad_school, by=c('idschool'))

ggplot(m, aes(x=AUTOADD,y=puntaje_estandar,color=rd,group=1)) + geom_point(alpha=0.7) + geom_smooth(method = "lm",  se = F) + scale_size(guide=FALSE) + xlab("Índice de autonomía administrativa de la escuela") + ylab("Puntaje Promedio por Escuela")
```
Sí se nota una relación entre la autonimía administrativa de la escuela y los logros de aprendizaje.  [JEV2IBG: creo que en esta figura el signo del indice de autonomiase invirtio: pensaria que las escuelas particulares tienen mas autonomia.  Sera un indice de "falta de autonomia"?]

```{r puntaje_AUTOACD, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Oficial","Particular")
levels(qd$ruralidad) <- c("Urbano","Rural")

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]
qf <- qf[,c("idschool","idstud","ISECF","INVOLUCF","CSOCBARF","SUPERVF","RECREAF","SERVBARF","VIOLBARF","MOTIVALF","subsgobf","padindig","madindig","DQFIT01","DQFIT25","DQFIT31","DQFIT34","DQFIT15_07","DQFIT18_02")]

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Particular') { return(0) } else if (r == 'Urbano' & d == 'Oficial') { return(1) } else if (r == 'Rural' & d == 'Particular') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_infrad_school <- aggregate(AUTOACD ~ idschool, qd, mean)
m <- merge(mean_school, mean_infrad_school, by=c('idschool'))

ggplot(m, aes(x=AUTOACD,y=puntaje_estandar,color=rd,group=1)) + geom_point(alpha=0.7) + geom_smooth(method = "lm",  se = F) + scale_size(guide=FALSE) + xlab("Índice de autonomía académica de la escuela") + ylab("Puntaje Promedio por Escuela")
```
Hay algún grado de relación entre la autonomía académica y los logros de aprendizaje.   [JEV2IBG: tambien pienso que se invirtio el signo del indice de autonomia academica]

```{r puntaje_CLAMBLD, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Oficial","Particular")
levels(qd$ruralidad) <- c("Urbano","Rural")

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]
qf <- qf[,c("idschool","idstud","ISECF","INVOLUCF","CSOCBARF","SUPERVF","RECREAF","SERVBARF","VIOLBARF","MOTIVALF","subsgobf","padindig","madindig","DQFIT01","DQFIT25","DQFIT31","DQFIT34","DQFIT15_07","DQFIT18_02")]

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Particular') { return(0) } else if (r == 'Urbano' & d == 'Oficial') { return(1) } else if (r == 'Rural' & d == 'Particular') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_infrad_school <- aggregate(CLAMBLD ~ idschool, qd, mean)
m <- merge(mean_school, mean_infrad_school, by=c('idschool'))

ggplot(m, aes(x=CLAMBLD,y=puntaje_estandar,color=rd,group=1)) + geom_point(alpha=0.7) + geom_smooth(method = "lm",  se = F) + scale_size(guide=FALSE) + xlab("Índice de calidad de ambiente laboral en la escuela (Director)") + ylab("Puntaje Promedio por Escuela")
```
Hay relación clara entre la calidad de ambiente laboral en la escuela (Director) y los logros de aprendizaje. 

### 6.3 Factores Asociados de Profesores

#### 6.3.1 Índices

```{r echo=F,message=F,warning=F}
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
profmat6 <- read.spss('./data/Profesores/QP_M6.SAV', to.data.frame=T)

pm6 <- pm6[pm6$country == 'PAN',]
profmat6 <- profmat6[profmat6$country == 'PAN',]

pm6 <- pm6[,c("sID","puntaje_estandar","idschool","nivel")]
names(pm6) <- c("sID","puntaje_estandar","idschool","nivel")

pm6 <- merge(pm6,profmat6,by="idschool")

pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)
proflec6 <- read.spss('./data/Profesores/QP_L6.SAV', to.data.frame=T)

pl6 <- pl6[pl6$country == 'PAN',]
proflec6 <- proflec6[proflec6$country == 'PAN',]

pl6 <- pl6[,c("sID","puntaje_estandar","idschool","nivel")]
names(pl6) <- c("sID","puntaje_estandar","idschool","nivel")

pl6 <- merge(pl6,proflec6,by="idschool")


pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
profcien6 <- read.spss('./data/Profesores/QP_M6.SAV', to.data.frame=T)

pc6 <- pc6[pc6$country == 'PAN',]
profcien6 <- profcien6[profcien6$country == 'PAN',]

pc6 <- pc6[,c("sID","puntaje_estandar","idschool","nivel")]
names(pc6) <- c("sID","puntaje_estandar","idschool","nivel")

pc6 <- merge(pc6,profcien6,by="idschool")

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6prof <- rbind.fill(pm6,pl6,pc6)
```

```{r puntaje_prof_MOTIVP, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + MOTIVP, p6prof, mean)
ggplot(a, aes(x=MOTIVP,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm",  se = F) + xlab("Índice de actitudes, motivación docente") + ylab("") 
```
```{r puntaje_prof_CLAMBP, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + CLAMBP, p6prof, mean)
ggplot(a, aes(x=CLAMBP,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm",  se = F) + xlab("Índice de actitudes, motivación docente") + ylab("") 
```
```{r puntaje_prof_RELSALP, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + RELSALP, p6prof, mean)
ggplot(a, aes(x=RELSALP,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm",  se = F) + xlab("Índice de actitudes, motivación docente") + ylab("") 
```
```{r puntaje_prof_RELDIRP, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + RELDIRP, p6prof, mean)
ggplot(a, aes(x=RELDIRP,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm",  se = F) + xlab("Índice de actitudes, motivación docente") + ylab("") 
```
```{r puntaje_prof_VIOLENP, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + VIOLENP, p6prof, mean)
ggplot(a, aes(x=VIOLENP,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm",  se = F) + xlab("Índice de actitudes, motivación docente") + ylab("") 
```
```{r puntaje_prof_APOYOP, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + APOYOP, p6prof, mean)
ggplot(a, aes(x=APOYOP,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm",  se = F) + xlab("Índice de actitudes, motivación docente") + ylab("") 
```
```{r puntaje_prof_LIDERAP, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + LIDERAP, p6prof, mean)
ggplot(a, aes(x=LIDERAP,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm",  se = F) + xlab("Índice de actitudes, motivación docente") + ylab("") 
```
```{r puntaje_prof_MONITOP, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + MONITOP, p6prof, mean)
ggplot(a, aes(x=MONITOP,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm",  se = F) + xlab("Índice de actitudes, motivación docente") + ylab("") 
```

#### 6.3.2 Datos de Profesores
```{r puntaje_prof_DQPIT01, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + DQPIT01, p6prof, mean)
ggplot(a, aes(x=DQPIT01,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm",  se = F) + xlab("Cual es su Edad?") + ylab("")
```

```{r puntaje_prof_DQPIT02, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT02 <- as.factor(p6prof$DQPIT02)
levels(p6prof$DQPIT02) <- c("Hombre","Mujer")
a <- aggregate(puntaje_estandar ~ DQPIT02 + tipo + DQPIT02, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT02)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Puntaje Promedio por Genero de Profesor')
```

```{r puntaje_prof_DQPIT03, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT03 <- as.factor(p6prof$DQPIT03)
levels(p6prof$DQPIT03) <- c("Castellano","Lengua Extranjera","Lengua Indigena 1","Lengua Indigena 2", "Otra Lengua")
a <- aggregate(puntaje_estandar ~ DQPIT03 + tipo + DQPIT03, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT03)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Puntaje Promedio por Genero de Profesor')
```

```{r puntaje_prof_DQPIT04, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + DQPIT04, p6prof, mean)
ggplot(a, aes(x=DQPIT04,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm",  se = F) + xlab(" ¿Hace cuantos años trabaja como docente?") + ylab("")
```

```{r puntaje_prof_DQPIT05, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + DQPIT05, p6prof, mean)
ggplot(a, aes(x=DQPIT05,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm",  se = F) + xlab("¿Hace cuantos años trabaja como docente en este centro educativo?") + ylab("")
```

```{r puntaje_prof_DQPIT07, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT07 <- as.factor(p6prof$DQPIT07)
levels(p6prof$DQPIT07) <- c("En la mañana","En la tarde","Jornada completa","Otra jornada")
a <- aggregate(puntaje_estandar ~ DQPIT07 + tipo + DQPIT07, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT07)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿En qué jornada asisten los estudiantes del aula evaluada?')
```

```{r puntaje_prof_DQPIT08, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT08 <- as.factor(p6prof$DQPIT08)
levels(p6prof$DQPIT08) <- c("Por tiempo indefinido","A plazo de 1yr","Menor a 1yr","Otro")
a <- aggregate(puntaje_estandar ~ DQPIT08 + tipo + DQPIT08, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT08)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Qué tipo de relación laboral tiene con este centro educativo?')
```

```{r puntaje_prof_DQPIT11, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT11 <- as.factor(p6prof$DQPIT11)
a <- aggregate(puntaje_estandar ~ DQPIT11 + tipo + DQPIT11, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT11)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Cuál es el nivel educativo más alto que usted ha completado?')
```

```{r puntaje_prof_DQPIT12_01, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT12_01 <- as.factor(p6prof$DQPIT12_01)
levels(p6prof$DQPIT12_01) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQPIT12_01 + tipo + DQPIT12_01, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT12_01)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Ha participado en alguna de las siguientes actividades..._He realizado un magíster')
```

```{r puntaje_prof_DQPIT12_02, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT12_02 <- as.factor(p6prof$DQPIT12_02)
levels(p6prof$DQPIT12_02) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQPIT12_02 + tipo + DQPIT12_02, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT12_02)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Ha participado en alguna de las siguientes actividades..._He realizado un diplomado')
```

```{r puntaje_prof_DQPIT12_07, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT12_07 <- as.factor(p6prof$DQPIT12_07)
levels(p6prof$DQPIT12_07) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQPIT12_07 + tipo + DQPIT12_07, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT12_07)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('No he realizado ninguna actividad de perfeccionamiento')
```

```{r puntaje_prof_DQPIT13, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT13 <- as.factor(p6prof$DQPIT13)
levels(p6prof$DQPIT13) <- c("Si, un mes", "Si, dos meses", "Si tres o mas meses", "No")
a <- aggregate(puntaje_estandar ~ DQPIT13 + tipo + DQPIT13, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT13)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿ha recibido usted alguna vez el apoyo y supervisión directa de un docente')
```

```{r puntaje_prof_DQPIT14, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT14 <- as.factor(p6prof$DQPIT14)
levels(p6prof$DQPIT14) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQPIT14 + tipo + DQPIT14, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT14)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Ha recibido usted alguna vez un incentivo económico por desempeño docente?')
```

### 6.4 Factores Asociados Familia

```{r echo=F,messages=F,warnings=F}
# load sexto grado puntajes
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6 <- rbind.fill(pm6,pl6,pc6)

p6 <- p6[p6$country == 'PAN',]

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]

pest <- merge(p6,qf,by='idstud')
```

#### 6.4.1 Indices

```{r puntaje_familia_SUPERVF, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=SUPERVF,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm",  se = F) + xlab("Índice de control y supervisión de estudios en el hogar") + ylab("")
```
```{r puntaje_familia_MOTIVALF, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=MOTIVALF,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm",  se = F) + xlab("Índice de motivación de lectura en el hogar") + ylab("")
```
```{r puntaje_familia_RECREAF, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=RECREAF,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm",  se = F) + xlab("Índice de actividades recreativas con la familia") + ylab("")
```
```{r puntaje_familia_INVOLUCF, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=INVOLUCF,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm",  se = F) + xlab("Índice de involucramiento de los padres en la escuela") + ylab("")
```
```{r puntaje_familia_SERVBARF, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=SERVBARF,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm",  se = F) + xlab("Índice de servicios en el barrio") + ylab("")
```
```{r puntaje_familia_CSOCBARF, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=CSOCBARF,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm",  se = F) + xlab("Índice de apoyo social en el barrio") + ylab("")
```
```{r puntaje_familia_VIOLBARF, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=VIOLBARF,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm",  se = F) + xlab("Índice de violencia en el barrio") + ylab("")
```

#### 6.4.2 Características de interés en las familias

```{r puntaje_familia_DQFIT01, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
pest$DQFIT01 <- as.factor(pest$DQFIT01)
levels(pest$DQFIT01) <- c("Madre","Padre","Abuelo","Hermano","Pareja del padre/madre", "Otro Familiar","Apoderado/Tutor")
a <- aggregate(puntaje_estandar ~ DQFIT01, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT01,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Cuál es su relación con el niño/la niña que está participando en la evaluación?') + coord_flip()
```

Estos siguientes factores estan muy asociados al indice sociocultural.

```{r puntaje_familia_DQFIT15_01, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT15_01 <- as.factor(pest$DQFIT15_01)
levels(pest$DQFIT15_01) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQFIT15_01, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT15_01,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Cuenta con alguno de los siguientes servicios en su hogar?_Luz eléctrica')
```
```{r puntaje_familia_DQFIT15_02, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT15_02 <- as.factor(pest$DQFIT15_02)
levels(pest$DQFIT15_02) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQFIT15_02, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT15_02,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Cuenta con alguno de los siguientes servicios en su hogar?_Agua Potable')
```
```{r puntaje_familia_DQFIT15_03, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT15_03 <- as.factor(pest$DQFIT15_03)
levels(pest$DQFIT15_03) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQFIT15_03, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT15_03,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Cuenta con alguno de los siguientes servicios en su hogar?_Desague o Alcantarillado')
```
```{r puntaje_familia_DQFIT15_04, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT15_04 <- as.factor(pest$DQFIT15_04)
levels(pest$DQFIT15_04) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQFIT15_04, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT15_04,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Cuenta con alguno de los siguientes servicios en su hogar?_Recoleccion de Basura')
```
```{r puntaje_familia_DQFIT15_05, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT15_05 <- as.factor(pest$DQFIT15_05)
levels(pest$DQFIT15_05) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQFIT15_05, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT15_05,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Cuenta con alguno de los siguientes servicios en su hogar?_Telefono Fijo')
```
```{r puntaje_familia_DQFIT15_06, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT15_06 <- as.factor(pest$DQFIT15_06)
levels(pest$DQFIT15_06) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQFIT15_06, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT15_06,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Cuenta con alguno de los siguientes servicios en su hogar?_Television por Cable o Satelital')
```
```{r puntaje_familia_DQFIT15_07, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT15_07 <- as.factor(pest$DQFIT15_07)
levels(pest$DQFIT15_07) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQFIT15_07, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT15_07,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Cuenta con alguno de los siguientes servicios en su hogar?_Internet')
```


```{r puntaje_familia_DQFIT32_01, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT32_01 <- as.factor(pest$DQFIT32_01)
levels(pest$DQFIT32_01) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQFIT32_01, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT32_01,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Me aseguro que el estudiante haya hecho todas las tareas escolares')
```

```{r puntaje_familia_DQFIT32_02, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT32_02 <- as.factor(pest$DQFIT32_02)
levels(pest$DQFIT32_02) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQFIT32_02, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT32_02,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Le pregunto al estudiante qué hizo en la escuela')
```

```{r puntaje_familia_DQFIT32_03, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT32_03 <- as.factor(pest$DQFIT32_03)
levels(pest$DQFIT32_03) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQFIT32_03, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT32_03,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Le pregunto al estudiante qué notas ha obtenido en la escuela')
```

```{r puntaje_familia_DQFIT33_01, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT33_01 <- as.factor(pest$DQFIT33_01)
levels(pest$DQFIT33_01) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQFIT33_01, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT33_01,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Recibo informes con las notas del estudiante')
```

```{r puntaje_familia_DQFIT33_02, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT33_02 <- as.factor(pest$DQFIT33_02)
levels(pest$DQFIT33_02) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQFIT33_02, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT33_02,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Recibo informes o comunicaciones sobre la conducta')
```

```{r puntaje_familia_DQFIT33_03, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT33_03 <- as.factor(pest$DQFIT33_03)
levels(pest$DQFIT33_03) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQFIT33_03, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT33_03,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Recibo informes sobre el desempeño de la escuela en pruebas..')
```

```{r puntaje_familia_DQFIT33_04, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT33_04 <- as.factor(pest$DQFIT33_04)
levels(pest$DQFIT33_04) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQFIT33_04, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT33_04,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Debo firmar las pruebas del estudiante')
```

```{r puntaje_familia_DQFIT33_05, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT33_05 <- as.factor(pest$DQFIT33_05)
levels(pest$DQFIT33_05) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQFIT33_05, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT33_05,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('De la escuela me citan para hablar sobre el estudiante')
```

### 6.5 Factores Asociados Alumnos

```{r echo=F,messages=F,warnings=F}
# load sexto grado puntajes
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6 <- rbind.fill(pm6,pl6,pc6)

p6 <- p6[p6$country == 'PAN',]

# load factores familia
qa <- read.spss('./data/Alumnos/QA6.SAV', to.data.frame=T)
qa <- qa[qa$country == 'PAN',]

pest <- merge(p6,qa,by='idstud')
```

#### 6.5.1 Indices

```{r puntaje_alumno_CONDIA6, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=CONDIA6,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm",  se = F) + xlab("Índice de condiciones de estudio en el hogar") + ylab("")
```

```{r puntaje_alumno_USOLIA6, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=USOLIA6,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm",  se = F) + xlab("Índice del uso de libro en el hogar") + ylab("")
```

```{r puntaje_alumno_TMPLIBA6, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=TMPLIBA6,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm",  se = F) + xlab("Índice de actividades recreativas en el hogar") + ylab("")
```

```{r puntaje_alumno_CLAMBIA6, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=CLAMBIA6,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm",  se = F) + xlab("Índice de calidad de ambiente en el aula") + ylab("")
```

```{r puntaje_alumno_ASISDOA6, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=ASISDOA6,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm",  se = F) + xlab("Índice de asistencia de docente") + ylab("")
```

```{r puntaje_alumno_PDORGCA6, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=PDORGCA6,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm",  se = F) + xlab("índice de prácticas docentes de organización y clima de aula") + ylab("")
```

```{r puntaje_alumno_PRACEDA6, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=PRACEDA6,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm",  se = F) + xlab("Índice practicas educativas 1") + ylab("")
```

```{r puntaje_alumno_PRACE2A6, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=PRACE2A6,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm",  se = F) + xlab("Índice practicas educativas 2") + ylab("")
```

```{r puntaje_alumno_PCEDUCA6, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=PCEDUCA6,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm",  se = F) + xlab("Índice de uso de computador educativo") + ylab("")
```

```{r puntaje_alumno_PCRECRA6, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=PCRECRA6,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm",  se = F) + xlab("Índice de uso de computador recreativo") + ylab("")
```

#### 6.4.2 Características de interés en las alumnos

```{r puntaje_alumno_trabaja, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$trabaja <- as.factor(pest$trabaja)
levels(pest$trabaja) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ trabaja, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=trabaja,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Trabajas?')
```

```{r puntaje_alumno_DQA6IT26, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQA6IT26 <- as.factor(pest$DQA6IT26)
levels(pest$DQA6IT26) <- c("No","Si, en casa","Si, fuera de casa")
a <- aggregate(puntaje_estandar ~ DQA6IT26, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQA6IT26,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Además de asistir a la escuela, ¿trabajas?')
```

```{r puntaje_alumno_DQA6IT26a, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQA6IT26a <- as.factor(pest$DQA6IT26a)
levels(pest$DQA6IT26a) <- c('Lo hago solo los fines de semana','La hago la mayor parte del tiempo en que no estoy en la escuela','Lo hago por poco rato cuando no estoy en la escuela',"No Trabaja")
a <- aggregate(puntaje_estandar ~ DQA6IT26a, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQA6IT26a,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Cuándo trabajas?')
```

```{r puntaje_alumno_DQA6IT26b, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQA6IT26b <- as.factor(pest$DQA6IT26b)
levels(pest$DQA6IT26b) <- c("Si","No","No, pero me dan cosas")
a <- aggregate(puntaje_estandar ~ DQA6IT26b, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQA6IT26b,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Te pagan por trabajar?')
```

#### Cuando no estás en clases, ¿qué haces con tu tiempo libre?

```{r puntaje_alumno_DQA6IT25_01, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQA6IT25_01 <- as.factor(pest$DQA6IT25_01)
levels(pest$DQA6IT25_01) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQA6IT25_01, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQA6IT25_01,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Veo televisión')
```

```{r puntaje_alumno_DQA6IT25_02, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQA6IT25_02 <- as.factor(pest$DQA6IT25_02)
levels(pest$DQA6IT25_02) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQA6IT25_02, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQA6IT25_02,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Juego juegos de consola o juegos de computador')
```
```{r puntaje_alumno_DQA6IT25_03, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQA6IT25_03 <- as.factor(pest$DQA6IT25_03)
levels(pest$DQA6IT25_03) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQA6IT25_03, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQA6IT25_03,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Navego en Internet')
```
```{r puntaje_alumno_DQA6IT25_04, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQA6IT25_04 <- as.factor(pest$DQA6IT25_04)
levels(pest$DQA6IT25_04) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQA6IT25_04, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQA6IT25_04,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Juego con mis amigos')
```
```{r puntaje_alumno_DQA6IT25_05, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQA6IT25_05 <- as.factor(pest$DQA6IT25_05)
levels(pest$DQA6IT25_05) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQA6IT25_05, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQA6IT25_05,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Leo libros o revistas')
```
```{r puntaje_alumno_DQA6IT25_06, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQA6IT25_06 <- as.factor(pest$DQA6IT25_06)
levels(pest$DQA6IT25_06) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQA6IT25_06, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQA6IT25_06,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Voy al cine o al teatro')
```
```{r puntaje_alumno_DQA6IT25_07, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQA6IT25_07 <- as.factor(pest$DQA6IT25_07)
levels(pest$DQA6IT25_07) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQA6IT25_07, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQA6IT25_07,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Voy al museo o a la biblioteca')
```

```{r puntaje_alumno_DQA6IT25_08, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQA6IT25_08 <- as.factor(pest$DQA6IT25_08)
levels(pest$DQA6IT25_08) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQA6IT25_08, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQA6IT25_08,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Hago deportes')
```
