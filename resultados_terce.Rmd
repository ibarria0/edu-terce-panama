---
output: pdf_document
---
## Presentación de resultados de Panamá en el Tercer Estudio Regional Comparativo y Explicativo (TERCE) del Laboratorio Latinoamericano de Evaluación de la Calidad de la Educación (LLECE)

### 1. Resumen
```{r init,results="hide",echo=F, message=F, warning=F}
library(foreign)
library(scales)
library(ggplot2)
library(plyr)

source('multiplot.R')
```

Hay grandes diferencias de oportunidades para nuestra niñez en materia educativa.   El Tercer Estudio Regional Comparativo y Explicativo (Terce, 2013) está diseñado para evaluar los logros educativos de los estudiantes mediante el puntaje obtenido en preguntas sobre lenguaje, matemáticas y ciencias.  Este estudio muestra que las diferencias de logros entre nuestros alumnos reflejan en forma marcada sus diferencias socioeconómicas y culturales, es decir, la inequidad.    

Este documento de divulgación es principalmente un llamado público a analizar los datos Terce disponibles en la página Web de Meduca y un reto a la voluntad nacional por crear un sistema educativo justo, capaz de brindar igualdad de oportunidades para todos.   

En el Terce las escuelas particulares mostraron mejores logros que las oficiales.  De nuestras escuelas oficiales, muchas muestran niveles de aprendizaje poco adecuados para la vida esperada de sus alumnos, especialmente entre las rurales. Esta divulgación se enfocará en explorar el efecto de factores del entorno que pueden incidir en los resultados educativos.  

Las diferencias de logros y su estrecha relación con las condiciones de vida se pueden ver en la figura 1.1 por ejemplo. Cada pequeño círculo representa el puntaje promedio y el índice socioeconómico y cultural promedio de los alumnos de una escuela. A mayor índice, más cómoda la situación de vida.  El tamaño de cada círculo es proporcional al número de alumnos en la escuela.  


```{r puntaje_isecf_rd, fig.width=12, fig.height=10, echo=F, message=F, warning=F}

# load sexto grado puntajes
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6 <- rbind.fill(pm6,pl6,pc6)
p6$promedio_global <- mean(p6$puntaje_estandar, na.rm=T)
p6$sd_global <- sd(p6$puntaje_estandar, na.rm=T)

p6 <- p6[p6$country == 'PAN',]

# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Oficial","Particular")
levels(qd$ruralidad) <- c("Urbano","Rural")

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]
qf <- qf[,c("idschool","idstud","ISECF","INVOLUCF","CSOCBARF","SUPERVF","RECREAF","SERVBARF","VIOLBARF","MOTIVALF","subsgobf","padindig","madindig","DQFIT01","DQFIT25","DQFIT31","DQFIT34","DQFIT15_07","DQFIT18_02")]

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Particular') { return(0) } else if (r == 'Urbano' & d == 'Oficial') { return(1) } else if (r == 'Rural' & d == 'Particular') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_isecf_school <- aggregate(ISECF ~ idschool, qf, mean)
m <- merge(mean_school, mean_isecf_school, by=c('idschool'))

ggplot(m, aes(x=ISECF,y=puntaje_estandar,color=rd,group=1,size=totalum)) + geom_point(alpha=0.7) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + scale_size(guide=FALSE) + xlab("Índice socioeconómico y cultural promedio de los alumnos de la escuela") + ylab("Puntaje promedio de los alumnos de la escuela") + ggtitle('Figura 1.1. Logros de aprendizaje por tipo de escuela, 6to grado') + scale_y_continuous(limits=c(500,850)) + scale_color_discrete(name = "Tipo de escuela")
```

Más importante que lamentar las debilidades observadas en estos logros es enfocarnos en oportunidades de mejora. Este es un mensaje central de este documento.  Por ejemplo, algunas escuelas oficiales rurales con bajo índice socioeconómico y cultural lograron puntajes superiores al promedio internacional de 700 puntos en el Terce y superiores al de las escuelas oficiales urbanas.   Estas escuelas tienen lecciones importantes para nuestro sistema educativo.     

En el contexto latinoamericano, Panamá obtuvo resultados por debajo de lo esperado para sus recursos.  La figura 1.2 confirma la tendencia conocida de que los alumnos de países con mayor producto interno bruto (PIB) per cápita obtienen mejores logros. Panamá obtuvo 39 puntos por debajo de la línea que modela los logros según el PIB per cápita de los países.   Estos resultados son similares a los que obtuvimos en evaluaciones internacionales previas: Serce 2006 y Pisa 2009. Es decir, Panamá puede y debe mejorar significativamente sus logros de aprendizaje.      


```{r puntaje_gdp, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
p6 <- rbind.fill(pm6,pl6,pc6)


gdp <- read.csv('./data/suplemental/gdp.csv')
names(gdp) <- c("Country_Name","country","gdp_2013")
m <- merge(p6,gdp,by="country")
a <- aggregate( puntaje_estandar ~ country + gdp_2013, m, mean)
ggplot(a, aes(x=gdp_2013, y=puntaje_estandar, color=country, group=1)) + geom_point() + geom_smooth(method = "lm", se = F) + geom_text(aes(label=country)) + xlab("Producto (PIB) per cápita") + ylab("Puntaje promedio") + ggtitle("Figura 1.2. Logros de aprendizaje en 6to grado según producto (PIB) per cápita por país") + scale_x_continuous(label=dollar) + scale_y_continuous(limits=c(600,810)) + scale_color_discrete(guide=F)

```

### 2. Introducción 


La educación nacional debe servir como un gran ecualizador hacia las mejores oportunidades de bienestar para todos, que renueve en cada generación las posibilidades de realización personal y de un país próspero sostenible.  

Nuestro sistema educativo dista mucho de este ideal.   Afortunadamente es posible evaluar los logros del sistema con métodos científicos que permitan recomendaciones confiables de cómo mejorar.   Una cultura que valora la información puede aprender de sus propios errores.    

Evaluaciones como el Terce tienen limitaciones propias del esquema de ítems, o preguntas que utilizan, y habrá que perfeccionar los métodos de evaluación a disposición de Panamá.  Sin embargo el Terce y otras evaluaciones estandarizadas son insumos valiosos de política educativa, especialmente cuando se analizan con conocimiento íntimo del contexto local.    

Esta es la segunda divulgación en torno al Terce y nuestro objetivo es mostrar la relación entre los logros obtenidos y ciertos factores de contexto que pueden ayudar a comprender la dinámica educativa, sin intentar ser exhaustivos.  Previamente, a fines de 2014, Unesco y Meduca divulgaron la comparación de resultados entre el Segundo Estudio Regional Comparativo y Explicativo, o Serce 2006, y el Terce 2013.   

Con esta divulgación Meduca invita a todos los interesados, especialmente aquellos familiarizados con métodos de análisis de evaluaciones educativas, a iniciar un gran movimiento de exploración de los datos educativos disponibles, como son los resultados de las evaluaciones Serce 2006, Sineca 2008, Pisa 2009 y Terce 2013.   

### 3. Terce y la participación de Panamá

**Muestra evaluada.** El Laboratorio Latinoamericano de Evaluación de la Calidad de la Educación, Llece, es una red de sistemas de evaluación educativa con sede en Chile coordinado por la Unesco que  diseña y administra evaluaciones a nivel regional.  El Terce es la tercera evaluación.   Cada país revisa y edita los ítems o preguntas de la evaluación para asegurar que terminan siendo apropiadas para su contexto nacional.     

El Terce evaluó 15 países de América Latina indicados en la figura 1.2 y la región de Nuevo León de México, que no aparece en esa figura de países.  El estudio evaluó lectura de tercero y sexto grado, escritura de tercero y sexto grado, matemáticas de tercero y sexto grado, y ciencias de sexto grado.  Los resultados de escritura de Panamá serán sujeto de una divulgación posterior.   

La muestra de alumnos por país es representativa hasta donde se interese cada país.  Por ejemplo, la muestra que gestionó Panamá permite comparar al sector oficial y particular, a los resultados por género y a otros aspectos, pero no permite comparaciones confiables entre provincias o comarcas.  Comprendemos que en el futuro debemos ampliar los aspectos que puedan ser explorados robustamente en las evaluaciones educativas del país.    

El Terce incluyó cuestionarios a los alumnos, docentes, directores de escuela y hogares de cada alumno sobre su entorno y situación para poder explorar el impacto de ciertos factores que podrían mostrar relación con los logros de aprendizaje, conocidos como factores asociados. Por ser conciso, este documento sólo presenta algunos de los varios factores asociados disponibles con el fin de abrir el tema a debate, sin intentar profundizar en más implicaciones pues las conclusiones finales deben ser resultado de un debate académico riguroso. 

Un total de `r length(unique(qd$idschool))` escuelas participaron en la prueba Terce representando cuatro tipos:  oficial urbana `r length(unique(qd[qd$dependencia == 'Oficial' & qd$ruralidad == "Urbano",]$idschool))`, oficial rural `r length(unique(qd[qd$dependencia == 'Oficial' & qd$ruralidad == "Rural",]$idschool))`, particular urbana `r length(unique(qd[qd$dependencia == 'Particular' & qd$ruralidad == "Urbano",]$idschool))` y particular rural `r length(unique(qd[qd$dependencia == 'Particular' & qd$ruralidad == "Rural",]$idschool))`.  En ellas participaron 3,631 estudiantes de tercer grado y 3,775 estudiantes de sexto grado.


```{r demo_pub_priv, fig.width=12, fig.height=7, echo=F, message=F, warning=F}
a <- aggregate(ruralidad ~ dependencia, qd, length)
ggplot(a, aes(x=dependencia, y=ruralidad)) + geom_bar(fill='#0072B2',stat="identity",width=.5) + ylab("Cantidad de escuelas") + ggtitle("Figura 3.1. Distribución de escuelas por sector escolar") +xlab("Sector escolar") + scale_y_continuous(limits=c(0,150))

```

```{r demo_ruralidad, fig.width=12, fig.height=7, echo=F, message=F, warning=F}
a <- aggregate(dependencia ~ ruralidad, qd, length)
ggplot(a, aes(x=ruralidad, y=dependencia)) + geom_bar(fill='#0072B2',stat="identity",width=.5) + ylab("Cantidad de escuelas") + ggtitle("Figura 3.2. Distribución de escuelas por ruralidad") + xlab("Ruralidad") + scale_y_continuous(limits=c(0,150))
```
**Condición socioeconómica y cultural de las escuelas.** Las escuelas de Panamá representan condiciones típicas de América Latina como muestra la figura 3.3 que compara nuestra situación con la de cuatro países de interés.  La distribución de nuestras escuelas según el índice socioeconómico y cultural promedio de sus alumnos se concentra cerca del valor promedio de la región, representado por el valor 0.0 del índice socioeconómico y cultural. 

```{r demo_isecf, fig.width=12, fig.height=12, echo=F, message=F, warning=F}

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
af <- qf[qf$country %in% c("CHL","CRI","URU","PAN","NIC"),]
af$country <- factor(af$country, levels = c("CHL","URU","CRI","PAN","NIC"))
ggplot(af, aes(x=ISECF)) + geom_histogram(fill='#0072B2') + ylab("Cantidad de escuelas") + facet_grid(country ~ ., scales='free_y') + scale_y_continuous(breaks=NULL) + geom_vline(x=0, colour="red", linetype = "longdash") + ggtitle("Figura 3.3. Distribución de escuelas según índice socioeconómico y cultural, comparada") + xlab("Índice socioeconómico y cultural")
```

**Edad, género y etnia.** Las edades de los participantes de tercero y sexto grado muestran que un grupo importante de ellos está sobre la edad esperada para su grado.    

```{r demo_genero_edad_3, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
qa3 <- read.spss('./data/Alumnos/QA3.SAV', to.data.frame=T)
qa3 <- qa3[qa3$country == 'PAN',]
qa3$DQA3IT01 <- as.factor(qa3$DQA3IT01)
qa3$DQA3IT02 <- as.factor(qa3$DQA3IT02)
levels(qa3$DQA3IT01) <- c("7 años o menos","8 años","9 años", "10 años", "11 años", "12 años o más", "NA")
levels(qa3$DQA3IT02) <- c("Niña","Niño")

ggplot(qa3, aes(x=DQA3IT01, fill=DQA3IT02)) + geom_histogram(aes(y = (..count..)/sum(..count..)), alpha=.5, position="dodge") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Cantidad de estudiantes")  + xlab("Edad") + ggtitle("Figura 3.4. Porcentaje de estudiantes de 3er grado por edad") + scale_y_continuous(labels = percent) + scale_fill_discrete(name="Género")
```

```{r demo_genero_edad_6, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
qa6 <- read.spss('./data/Alumnos/QA6.SAV', to.data.frame=T)
qa6 <- qa6[qa6$country == 'PAN',]
qa6$DQA6IT01 <- as.factor(qa6$DQA6IT01)
qa6$DQA6IT02 <- as.factor(qa6$DQA6IT02)
levels(qa6$DQA6IT01) <- c("10 años o menos","11 años","12 años", "13 años", "14 años", "15 años o más", "NA")
levels(qa6$DQA6IT02) <- c("Niña","Niño")

ggplot(qa6, aes(x=DQA6IT01, fill=DQA6IT02)) + geom_histogram(aes(y = (..count..)/sum(..count..)), alpha=.5, position="dodge") + scale_x_discrete(labels=c("10 años o menos","11 años","12 años", "13 años", "14 años", "15 años o más", "NA")) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Cantidad de estudiantes") + xlab("Edad") + ggtitle("Figura 3.5. Porcentaje de estudiantes de 6to grado por edad")  + scale_y_continuous(labels = percent) + scale_fill_discrete(name="Género")
```

Las figuras 3.6 y 3.7 muestran las respuestas de los alumnos a las preguntas sobre el género al que pertenecen y si pertenecen a una etnia originaria de Panamá.  No se logró respuesta válida de un número pequeño pero importante de esos alumnos.   

```{r demo_genelaro, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
qa6 <- read.spss('./data/Alumnos/QA6.SAV', to.data.frame=T)
qa6 <- qa6[qa6$country == 'PAN',]
qa6$DQA6IT02 <- as.factor(qa6$DQA6IT02)
levels(qa6$DQA6IT02) <- c("Niña","Niño")

ggplot(qa6, aes(x=DQA6IT02)) + geom_histogram(aes(y = (..count..)/sum(..count..)),fill='#0072B2',width=0.5,position="dodge")  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Porcentaje de estudiantes") + xlab("¿Eres niña o niño?") + ggtitle("Figura 3.6. Respuesta a la pertenencia de género") + scale_y_continuous(labels = percent,limits=c(0,0.75))
```

```{r etnia, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
qa6 <- read.spss('./data/Alumnos/QA6.SAV', to.data.frame=T)
qa6 <- qa6[qa6$country == 'PAN',]
qa6$DQA6IT06 <- as.factor(qa6$DQA6IT06)
levels(qa6$DQA6IT06) <- c("No","Si")

ggplot(qa6, aes(x=DQA6IT06)) + geom_histogram(aes(y = (..count..)/sum(..count..)),fill='#0072B2',width=0.5, position="dodge")  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Porcentaje de estudiantes") + xlab("¿Perteneces a alguna etnia indígena?") + ggtitle("Figura 3.7. Respuesta a la pertenencia de etnia originaria") + scale_y_continuous(labels = percent,limits=c(0,0.75))
```

## 4. Comparación con América Latina

**Logros según PIB per cápita.** Comparar resultados entre países es útil pero no lo principal. El Terce no es una competencia por el mayor puntaje promedio sino un esfuerzo por comprender la dinámica educativa para tomar acción.  Los comentarios siguientes toman ese punto de vista. 

Entre los países participantes Chile obtuvo el mejor resultado seguido de Costa Rica y México, como muestran las figuras 4.1 y 4.2 para tercero y sexto grado respectivamente. La figura 4.2 es la figura 1.2 repetida aquí por conveniencia.  Panamá obtiene resultados de 34 o 39 puntos por debajo de lo esperado, en tercero y sexto grado respectivamente, para su PIB per cápita.  Esta tendencia también se notó en las evaluaciones previas Serce 2006 y Pisa 2009. 

Costa Rica sirve como ejemplo de que un país de escala y ubicación similar a la nuestra puede obtener mejores logros.  Con esta observación y nuestra riqueza nacional parece razonable confiar que podemos mejorar resultados si le damos la prioridad social necesaria a nuestra educación.   

```{r puntaje_gdp_3, fig.width=12, fig.height=10, echo=F, message=F, warning=F}		
		
pm3 <- read.spss('./data/Puntajes_Alumnos/PM3_all_TERCE.sav', to.data.frame=T)		
pl3 <- read.spss('./data/Puntajes_Alumnos/PL3_all_TERCE.sav', to.data.frame=T)		
		
pm3$tipo <- 'matematica'		
pl3$tipo <- 'lectura'		
		
p3 <- rbind.fill(pm3,pl3)		
gdp <- read.csv('./data/suplemental/gdp.csv')		
names(gdp) <- c("Country_Name","country","gdp_2013")		
m <- merge(p3,gdp,by="country")		
a <- aggregate( puntaje_estandar ~ country + gdp_2013, m, mean)		
ggplot(a, aes(x=gdp_2013, y=puntaje_estandar, color=country, group=1)) + geom_point() + geom_smooth(method = "lm", se = F) + geom_text(aes(label=country)) + xlab("Producto (PIB) per cápita") + ylab("Puntaje promedio") + ggtitle("Figura 4.1. Logros de aprendizaje en 3er grado según producto (PIB) per cápita por país") + scale_x_continuous(label=dollar) + scale_y_continuous(limits=c(600,810)) + scale_color_discrete(guide=F)
``` 

```{r puntaje_gdp_6, fig.width=12, fig.height=10, echo=F, message=F, warning=F}		
	
# load sexto grado puntajes
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6 <- rbind.fill(pm6,pl6,pc6)
p6$promedio_global <- mean(p6$puntaje_estandar, na.rm=T)
p6$sd_global <- sd(p6$puntaje_estandar, na.rm=T)
p6 <- rbind.fill(pm6,pl6,pc6)

gdp <- read.csv('./data/suplemental/gdp.csv')
names(gdp) <- c("Country_Name","country","gdp_2013")
m <- merge(p6,gdp,by="country")
a <- aggregate( puntaje_estandar ~ country + gdp_2013, m, mean)
ggplot(a, aes(x=gdp_2013, y=puntaje_estandar, color=country, group=1)) + geom_point() + geom_smooth(method = "lm", se = F) + geom_text(aes(label=country)) + xlab("Producto (PIB) per cápita") + ylab("Puntaje promedio") + ggtitle("Figura 4.2. Logros de aprendizaje en 6to grado según producto (PIB) per cápita por país") + scale_x_continuous(label=dollar) + scale_y_continuous(limits=c(600,810)) + scale_color_discrete(guide=F)
``` 

**Logros de aprendizaje.** Más relevante que nuestra posición relativa es saber si lo que nuestros niños y niñas logran aprender es útil para su propio bienestar y la prosperidad de la nación. La evaluación Terce define cuatro niveles de logros de aprendizaje.  El nivel 1 se considera poca  preparación para la vida esperada de los participantes y el nivel 4 la mejor preparación.  Corresponden a un dominio progresivamente más eficaz del área de conocimiento de interés.  

La definición de los niveles, con sus rangos de puntajes correspondientes, se basa en una escala de habilidades y saberes por área de conocimiento y grado.  La descripción de los niveles está disponible en el sitio web llece.org en la publicación *Primera entrega de resultados terce* de la Unesco, Oficina Regional de Santiago, Chile, diciembre 2014, capítulo 2, niveles de desempeño SERCE, y es igual a la del Serce 2006 por comparabilidad. 

Salvo en lectura de sexto grado, cerca de 40% de nuestras niñas y niños obtienen logros de aprendizaje de nivel 1 y en matemáticas de sexto grado es más del 60%.  Las figuras 4.3 y 4.4 muestran los porcentajes de alumnos de Panamá en cada nivel comparados con los del resto de alumnos. Ésta es, quizás, la información más relevante sobre nuestra situación.   

```{r niveles_barcharts_3, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
p6 <- rbind.fill(pm6,pl6,pc6)
p6$grado <- '6'

pm3 <- read.spss('./data/Puntajes_Alumnos/PM3_all_TERCE.sav', to.data.frame=T)
pl3 <- read.spss('./data/Puntajes_Alumnos/PL3_all_TERCE.sav', to.data.frame=T)

pm3$tipo <- 'matemática'
pl3$tipo <- 'lectura'

p3 <- rbind.fill(pm3,pl3)

p3$grado <- '3'

p <- rbind.fill(p6,p3)

ispan <- function(x) { if(x == 'PAN') { return("PAN") } else { return("OTROS") } }
p$countryp <- sapply(p$country,ispan)
a <- aggregate(puntaje_estandar ~ nivel + countryp + tipo + grado, p, length)
calc_percent <- function(c,t,g,x) { return((x/sum(a[a$countryp == c & a$tipo == t & a$grado == g,]$puntaje_estandar))) }
a$dist <- mapply(calc_percent, a$countryp, a$tipo, a$grado, a$puntaje_estandar)

#####
ggplot(a[a$grado == 3,], aes(x=nivel,y=dist,fill=countryp)) + geom_bar(stat="identity", position=position_dodge(), colour="black") + xlab("Nivel de logros de aprendizaje") + ylab("Porcentaje de estudiantes") + ggtitle("Figura 4.3. Porcentaje de estudiantes por nivel de logros, 3er grado") + facet_grid(tipo ~ .) + scale_fill_manual(values=c("#FFCB00","#FFA100"),name="País") + scale_y_continuous(labels = percent, limits=c(0,0.7))
```

```{r niveles_barcharts_6, fig.width=12, fig.height=15, echo=F, message=F, warning=F}
ggplot(a[a$grado == 6,], aes(x=nivel,y=dist,fill=countryp)) + geom_bar(stat="identity", position=position_dodge(), colour="black") + xlab("Nivel de logros de aprendizaje") + ylab("Porcentaje de estudiantes") + ggtitle("Figura 4.4. Porcentaje de estudiantes por nivel de logros, 6to grado") + facet_grid(tipo ~ .) + scale_fill_manual(values=c("#FFCB00","#FFA100"),name="País") + scale_y_continuous(labels = percent, limits=c(0,0.7))
```


## 5 Resultados según género, etnia originaria y nivel socioeconómico y cultural

**Logros según género y etnia.** Las niñas obtuvieron resultados ligeramente mejores que los niños en lectura de tercero y sexto grado, matemáticas de tercero y sexto grado y ciencias de sexto grado, pero la ventaja no es clara.   La figura 5.1 compara los logros combinando las tres áreas de conocimiento.  Los datos excluyen alumnos para los cuales no se pudo obtener respuesta de género válida.     

```{r demo_genero_puntaje, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
p6 <- p6[p6$country == 'PAN',]
qa6$DQA6IT02 <- as.factor(qa6$DQA6IT02)

genero <- merge(p6,qa6,by='idstud')
a <- aggregate(puntaje_estandar ~ DQA6IT02, genero, mean)
a$dif <- (a$puntaje_estandar - mean(p6$puntaje_estandar,na.rm=T))/sd(p6$puntaje_estandar,na.rm=T)
levels(a$DQA6IT02) <- c("Niña","Niño")
dif <- data.frame(genero=c("Niña"),std_mean=c(a$dif[1] - a$dif[2]))

ggplot(a, aes(x=DQA6IT02,y=puntaje_estandar,fill=DQA6IT02)) + geom_bar(stat='identity',width=0.25) + ggtitle("Figura 5.1.  Puntaje promedio comparado entre géneros") + ylab("Puntaje promedio") + xlab("Género") + scale_fill_discrete(guide=F)
```

Los alumnos que se reconocen como miembros de etnias originarias logran menor puntaje que los que no se consideran miembros.  La figura 5.2 compara los logros combinando las tres áreas de conocimiento y la diferencia es clara.   Los datos excluyen alumnos para los cuales no se pudo obtener respuesta de etnia originaria válida.    


```{r demo_etnia_puntaje, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
qa6$DQA6IT06 <- as.factor(qa6$DQA6IT06)

genero <- merge(p6,qa6,by='idstud')
a <- aggregate(puntaje_estandar ~ DQA6IT06, genero, mean)
a$dif <- (a$puntaje_estandar - mean(p6$puntaje_estandar,na.rm=T))/sd(p6$puntaje_estandar,na.rm=T)
levels(a$DQA6IT06) <- c("No originarios","Originarios")

ggplot(a, aes(x=DQA6IT06,y=puntaje_estandar,fill=DQA6IT06)) + geom_bar(stat='identity',width=0.25) + ggtitle("Figura 5.2. Puntaje promedio comparado según pertenencia a grupos originarios") + ylab("Puntaje promedio") + xlab("Etnia") + scale_fill_discrete(guide=F)
```

**Logros según condición de escuelas.** Otro aspecto importante de equidad o falta de ella tiene relación con las condiciones de vida.  La educación y la salud son determinantes para el bienestar de un individuo. Cuando los logros de aprendizaje dependen marcadamente del nivel socioeconómico y cultural de una persona es difícil argumentar que la sociedad brinda oportunidades por igual.  Este es el caso de Panamá.     

Las figuras 5.3 y 5.4 muestran el puntaje promedio, combinando todas las áreas de conocimiento, obtenido por los alumnos de nuestras escuelas y el índice socioeconómico y cultural promedio de esos alumnos.  La figura 5.4 es la misma figura 1.1 repetida aquí por conveniencia.  El puntaje promedio internacional en el Terce fue 700 puntos para todas las áreas de conocimiento. 

La línea azul en estas figuras muestra que los logros reflejan en forma apreciable las diferencias socioeconómicas y culturales que se vive en las escuelas. A la vez, conviene notar que un grupo de escuelas oficiales rurales obtuvieron logros superiores al promedio internacional e incluso algunas superaron en sexto grado a las escuelas oficiales urbanas a pesar de tener índices socioeconómicos y culturales apreciablemente menores. Estas escuelas deben convertirse en sujeto de estudio y fuente de lecciones aprendidas.   

```{r puntaje_isecf_rd_3, fig.width=12, fig.height=10, echo=F, message=F, warning=F}		
		
# load sexto grado puntajes		
pm3 <- read.spss('./data/Puntajes_Alumnos/PM3_all_TERCE.sav', to.data.frame=T)		
pl3 <- read.spss('./data/Puntajes_Alumnos/PL3_all_TERCE.sav', to.data.frame=T)		
		
pm3 <- pm3[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]		
pl3 <- pl3[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]		
		
# merge matematica, lectura y ciencias		
pm3$tipo <- 'matematica'		
pl3$tipo <- 'lectura'		
p3 <- rbind.fill(pm3,pl3)		
		
p3 <- p3[p3$country == 'PAN',]		
		
# load factores alumnos		
qd <- read.spss('./data/Directores/QD3.SAV', to.data.frame=T)		
qd <- qd[qd$country == 'PAN',]		
		
qd$dependencia <- as.factor(qd$dependencia)		
qd$ruralidad <- as.factor(qd$ruralidad)		
levels(qd$dependencia) <- c("Oficial","Particular")		
levels(qd$ruralidad) <- c("Urbano","Rural")		
		
# load factores familia		
qf <- read.spss('./data/Familia/QF3.SAV', to.data.frame=T)		
qf <- qf[qf$country == 'PAN',]		
qf <- qf[,c("idschool","idstud","ISECF","INVOLUCF","CSOCBARF","SUPERVF","RECREAF","SERVBARF","VIOLBARF","MOTIVALF","subsgobf","padindig","madindig","DQFIT01","DQFIT25","DQFIT31","DQFIT34","DQFIT15_07","DQFIT18_02")]		
		
pe <- merge(p3,qd,by='idschool')		
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Particular') { return(0) } else if (r == 'Urbano' & d == 'Oficial') { return(1) } else if (r == 'Rural' & d == 'Particular') {return(2)} else {return(3)}}		
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))		
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")		
		
mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)		
mean_isecf_school <- aggregate(ISECF ~ idschool, qf, mean)		
m <- merge(mean_school, mean_isecf_school, by=c('idschool'))		
		
ggplot(m, aes(x=ISECF,y=puntaje_estandar,color=rd,group=1,size=totalum)) + geom_point(alpha=0.7) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + scale_size(guide=FALSE) + xlab("Índice socioeconómico y cultural promedio de los alumnos de la escuela") + ylab("Puntaje promedio de los alumnos de la escuela") + ggtitle('Figura 5.3. Logros de aprendizaje por tipo de escuela, 3er grado') + scale_y_continuous(limits=c(500,850)) + scale_colour_discrete(name="Tipo de escuela")		
```

```{r puntaje_isecf_rd_6, fig.width=12, fig.height=10, echo=F, message=F, warning=F}

# load sexto grado puntajes
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6 <- rbind.fill(pm6,pl6,pc6)
p6$promedio_global <- mean(p6$puntaje_estandar, na.rm=T)
p6$sd_global <- sd(p6$puntaje_estandar, na.rm=T)

p6 <- p6[p6$country == 'PAN',]

# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Oficial","Particular")
levels(qd$ruralidad) <- c("Urbano","Rural")

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]
qf <- qf[,c("idschool","idstud","ISECF","INVOLUCF","CSOCBARF","SUPERVF","RECREAF","SERVBARF","VIOLBARF","MOTIVALF","subsgobf","padindig","madindig","DQFIT01","DQFIT25","DQFIT31","DQFIT34","DQFIT15_07","DQFIT18_02")]

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Particular') { return(0) } else if (r == 'Urbano' & d == 'Oficial') { return(1) } else if (r == 'Rural' & d == 'Particular') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_isecf_school <- aggregate(ISECF ~ idschool, qf, mean)
m <- merge(mean_school, mean_isecf_school, by=c('idschool'))

ggplot(m, aes(x=ISECF,y=puntaje_estandar,color=rd,group=1,size=totalum)) + geom_point(alpha=0.7) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + scale_size(guide=FALSE) + xlab("Índice socioeconómico y cultural promedio de los alumnos de la escuela") + ylab("Puntaje promedio de los alumnos de la escuela") + ggtitle('Figura 5.4. Logros de aprendizaje por tipo de escuela, 6to grado') + scale_y_continuous(limits=c(500,850)) + scale_colour_discrete(name="Tipo de escuela")
```

## 6 Otros factores asociados de interés

**Importancia de cautela con los resultados.** Los factores asociados son características o circunstancias cuantificables que podrían mostrar una relación significativa con los logros de aprendizaje.  La información sobre factores fue recopilada durante el Terce usando cuestionarios a los alumnos, docentes, directores de escuelas y familias involucradas. Este documento sólo incluye algunos de los muchos factores que se pueden y deben explorar.  La intención es provocar un debate nacional, no crear una enciclopedia de factores asociados.     

El que un factor muestre relación con los logros de aprendizaje no prueba que sea la causa o síntoma de esos logros.   A modo de ejemplo, una mejor situación socioeconómica y cultural da la oportunidad de asistir a una mejor escuela, con mejor  infraestructura y más eficacia, sin que sea claro cuáles de estos tres factores merece más crédito por los aprendizajes logrados.  El lector debe tener presente que muchos de los factores explorados en esta sección tienen relación potencial con el índice socioeconómico y cultural, por tanto juzgar su importancia requerirá un debate académico más extenso y riguroso.  

**Infraestructura y autonomía.** En las figuras siguientes sobre el entorno escolar, los puntos dentro de la figura representan escuelas y sus tamaños esta vez no son proporcionales al número de alumnos en la escuela.   Las líneas ilustran un modelo líneal de relación entre logros y el factor de interés.  La figura 6.1 muestra el efecto del índice de infraestructura de la escuela. La relación es marcada: a mejor infraestructura mayor puntaje promedio de las escuelas.   Por supuesto, éste es uno de los factores que puede estar reflejando el índice socioeconómico y cultural de los alumnos de las escuelas.   

```{r puntaje_INFRAD, fig.width=12, fig.height=10, echo=F, message=F, warning=F}

# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Oficial","Particular")
levels(qd$ruralidad) <- c("Urbano","Rural")

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]
qf <- qf[,c("idschool","idstud","ISECF","INVOLUCF","CSOCBARF","SUPERVF","RECREAF","SERVBARF","VIOLBARF","MOTIVALF","subsgobf","padindig","madindig","DQFIT01","DQFIT25","DQFIT31","DQFIT34","DQFIT15_07","DQFIT18_02")]

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Particular') { return(0) } else if (r == 'Urbano' & d == 'Oficial') { return(1) } else if (r == 'Rural' & d == 'Particular') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_infrad_school <- aggregate(INFRAD ~ idschool, qd, mean)
m <- merge(mean_school, mean_infrad_school, by=c('idschool'))

ggplot(m, aes(x=INFRAD,y=puntaje_estandar,color=rd,group=1)) + geom_point(alpha=0.7) + geom_smooth(method = "lm", se = F) + scale_size(guide=FALSE) + xlab("Índice de infraestructura de la escuela") + ylab("Puntaje promedio por escuela") +  ggtitle('Figura 6.1. Logros de aprendizaje según infraestructura escolar') + scale_y_continuous(limits=c(500,850)) + scale_colour_discrete(name="Tipo de escuela") 
```
La autonomía administrativa de la escuela muestra relación con los logros de aprendizaje de sus alumnos.  El índice en la figura 6.2 procede de un ranking pero expresado con promedio 0: a menor índice mayor autonomía. Así, las escuelas particulares, de mayor autonomía, aparecen en el extremo izquierdo de la figura con los índices más bajos.   

```{r puntaje_AUTOADD, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Oficial","Particular")
levels(qd$ruralidad) <- c("Urbano","Rural")

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]
qf <- qf[,c("idschool","idstud","ISECF","INVOLUCF","CSOCBARF","SUPERVF","RECREAF","SERVBARF","VIOLBARF","MOTIVALF","subsgobf","padindig","madindig","DQFIT01","DQFIT25","DQFIT31","DQFIT34","DQFIT15_07","DQFIT18_02")]

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Particular') { return(0) } else if (r == 'Urbano' & d == 'Oficial') { return(1) } else if (r == 'Rural' & d == 'Particular') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_infrad_school <- aggregate(AUTOADD ~ idschool, qd, mean)
m <- merge(mean_school, mean_infrad_school, by=c('idschool'))

ggplot(m, aes(x=AUTOADD,y=puntaje_estandar,color=rd,group=1)) + geom_point(alpha=0.7) + geom_smooth(method = "lm",  se = F) + scale_size(guide=FALSE) + xlab("Índice de autonomía administrativa de la escuela (menor índice = mayor autonomía)") + ylab("Puntaje promedio por escuela") +  ggtitle('Figura 6.2. Logros de aprendizaje según autonomía administrativa') + scale_y_continuous(limits=c(500,850)) + scale_colour_discrete(name="Tipo de escuela")
```

**Motivación y edad docente.** En las dos figuras siguientes los puntos corresponden a docentes de sexto grado y muestran el promedio obtenido por sus estudiantes contra una característica del profesor: motivación en la figura 6.3 y edad en la figura 6.4. El color del punto indica el área de conocimiento.  

Curiosamente, se ve poca relación entre la motivación docente y los logros de aprendizajes.  Por ejemplo, en la figura 6.3 el valor de puntaje en la línea que modela la relación logro-motivación no varía mucho de 670 puntos, aunque el índice varía de -2 a +2. Esta observación seguramente será sujeto de mayor validación y análisis.   

```{r echo=F,message=F,warning=F}
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
profmat6 <- read.spss('./data/Profesores/QP_M6.SAV', to.data.frame=T)

pm6 <- pm6[pm6$country == 'PAN',]
profmat6 <- profmat6[profmat6$country == 'PAN',]

pm6 <- pm6[,c("sID","puntaje_estandar","idschool","nivel")]
names(pm6) <- c("sID","puntaje_estandar","idschool","nivel")

pm6 <- merge(pm6,profmat6,by="idschool")

pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)
proflec6 <- read.spss('./data/Profesores/QP_L6.SAV', to.data.frame=T)

pl6 <- pl6[pl6$country == 'PAN',]
proflec6 <- proflec6[proflec6$country == 'PAN',]

pl6 <- pl6[,c("sID","puntaje_estandar","idschool","nivel")]
names(pl6) <- c("sID","puntaje_estandar","idschool","nivel")

pl6 <- merge(pl6,proflec6,by="idschool")


pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
profcien6 <- read.spss('./data/Profesores/QP_M6.SAV', to.data.frame=T)

pc6 <- pc6[pc6$country == 'PAN',]
profcien6 <- profcien6[profcien6$country == 'PAN',]

pc6 <- pc6[,c("sID","puntaje_estandar","idschool","nivel")]
names(pc6) <- c("sID","puntaje_estandar","idschool","nivel")

pc6 <- merge(pc6,profcien6,by="idschool")

# merge matematica, lectura y ciencias
pm6$tipo <- 'matemática'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6prof <- rbind.fill(pm6,pl6,pc6)
p6prof <- p6prof[!is.na(p6prof$idtealin),]
```

```{r puntaje_prof_MOTIVP, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + MOTIVP, p6prof, mean)
ggplot(a, aes(x=MOTIVP,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm",  se = F) + xlab("Índice de actitudes y motivación del docente") + ylab("Puntaje promedio de los alumnos del docente") +  ggtitle('Figura 6.3. Logros de aprendizaje según movitación docente') + scale_y_continuous(limits=c(475,850)) + scale_colour_discrete(name="Área")
```
La edad de los docentes sí parece relevante en las diferencias de logros de los aprendizajes.    

```{r puntaje_prof_DQPIT01, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + DQPIT01, p6prof, mean)
ggplot(a, aes(x=DQPIT01,y=puntaje_estandar,,group=1,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm",  se = F) + xlab("Edad del docente") + ylab("Puntaje promedio de los alumnos del docente")  +  ggtitle('Figura 6.4. Logros de aprendizaje según edad del docente') + scale_y_continuous(limits=c(475,850)) + scale_colour_discrete(name="Área")
```
**Efecto de factores asociados.** Las figuras 6.5 a 6.8 siguientes ilustran el efecto de ciertas características de interés relacionadas con docentes de sexto grado y las jornadas a su disposición.  Por ejemplo, podríamos explorar si el subgrupo de alumnos cuyos docentes tienen alta formación obtiene mayores logros de aprendizaje.  El *efecto* de esa alta formación consiste en notar el puntaje promedio de ese subgrupo de alumnos y restarle el puntaje promedio del grupo total de alumnos de Panamá en el Terce.  Cuando este efecto es positivo y de suficiente magnitud se entiende que el subgrupo obtiene mejores resultados que el promedio del grupo total.  

Para simplificar, el promedio del grupo total está representado en las figuras por el valor 0 en el eje vertical y la magnitud del efecto, o diferencia entre promedios, se expresa en desviaciones estándar, que es una medida conocida de diferencias estadísticas.  Es importante tomar en cuenta que las características ilustradas por las distintas figuras pueden tener dependencias no evidentes entre si y que las categorías comparadas en una misma figura pueden reflejar otras dinámicas subyacentes como la naturaleza de escuelas particulares versus oficiales.  Los resultados en las figuras deben servir como punto de partida para investigar con rigurosidad sus implicaciones o explicaciones en lugar de ser interpretados como conclusiones.    

**Lengua materna del docente.** Empecemos con la figura 6.5.  La lengua materna del docente parece tener relación con los logros de aprendizaje.  Cuando la lengua materna es extranjera el efecto es positivo y muy elevado en matemáticas.  Éste es uno de los efectos más significativos entre los distintos factores, pero es importante advertir que el efecto no es prueba de que esa característica del docente sea la causa o garantía de los mejores resultados de matemática obtenidos por sus alumnos.  

```{r puntaje_prof_DQPIT03, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT03 <- as.factor(p6prof$DQPIT03)
levels(p6prof$DQPIT03) <- c("Castellano","Lengua extranjera","Lengua indígena 1","Lengua indígena 2", "Otra lengua")
a <- aggregate(puntaje_estandar ~ DQPIT03 + tipo + DQPIT03, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT03)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("Desviación estándar") + scale_y_continuous(limits=c(-1.2,1.5)) + ggtitle('Figura 6.5. Efecto de lengua materna del docente') + scale_fill_discrete(name="Lengua")
```
**Jornada escolar.** La jornada completa también tiene un efecto positivo importante en el logro de los aprendizajes, aunque menor que la lengua materna del docente.   

```{r puntaje_prof_DQPIT07, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT07 <- as.factor(p6prof$DQPIT07)
levels(p6prof$DQPIT07) <- c("En la mañana","En la tarde","Jornada completa","Otra jornada")
a <- aggregate(puntaje_estandar ~ DQPIT07 + tipo + DQPIT07, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT07)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("Desviación estándar") + scale_y_continuous(limits=c(-1.2,1.5)) + ggtitle('Figura 6.6. Efecto del tipo de jornada') + scale_fill_discrete(name="Jornada")
```

**Incentivos económicos.** Los incentivos económicos por desempeño para el docente muestran un efecto positivo en los logros de aprendizaje, aunque un poco menor que la jornada única.  

```{r puntaje_prof_DQPIT14, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT14 <- as.factor(p6prof$DQPIT14)
levels(p6prof$DQPIT14) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQPIT14 + tipo + DQPIT14, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT14)) + geom_bar(stat='identity',position='dodge') + xlab("¿Ha recibido usted alguna vez un incentivo económico por desempeño docente") + ylab("Desviación estándar") + ggtitle('Figura 6.7. Efecto si el docente ha recibido o no incentivos económicos por desempeño') + scale_y_continuous(limits=c(-1.2,1.5)) + scale_fill_discrete(name="¿Incentivos?")
```
**Nivel de formación docente.** La especialización del docente más allá de la educación terciaria muestra un efecto positivo, aunque menor que los incentivos por desempeño al docente.  Los niveles de formación docente corresponden a la clasificación internacional normalizada de la educación del Instituto de Estadística de la Unesco.   

```{r puntaje_prof_DQPIT11, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT11 <- as.factor(p6prof$DQPIT11)
levels(p6prof$DQPIT11) <- c("Primaria o secundaria baja","Secundaria alta","Postsecundaria no terciaria o terciaria de ciclo corto","Terciaria", "Maestría o especialización")
a <- aggregate(puntaje_estandar ~ DQPIT11 + tipo + DQPIT11, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT11)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("Desviación estándar") + ggtitle('Figura 6.8. Efecto del nivel de educación completado por el docente') + scale_y_continuous(limits=c(-1.2,1.5)) + scale_fill_discrete(name="Nivel")
```
**Recreación con la familia.** En las dos últimas figuras, los puntos corresponden a alumnos.  Cada punto indica el puntaje obtenido en un área de conocimiento y el valor del índice de interés correspondiente al alumno.   

```{r echo=F,messages=F,warnings=F}
# load sexto grado puntajes
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6 <- rbind.fill(pm6,pl6,pc6)

p6 <- p6[p6$country == 'PAN',]

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]

pest <- merge(p6,qf,by='idstud')
```
Las actividades recreativas con la familia muestran un efecto positivo, como ilustra la línea que modela la relación logros-actividades.  Es decir, a mayor índice de actividades recreativas con la familia mayor puntaje obtienen los alumnos correspondientes.  

```{r puntaje_familia_RECREAF, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=RECREAF,y=puntaje_estandar,group=1,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm",  se = F) + xlab("Índice de actividades recreativas con la familia") + ylab("Puntaje de los alumnos") + ggtitle('Figura 6.9. Efecto de recreación con la familia') + scale_y_continuous(limits=c(200,1200)) + scale_color_discrete(name="Área")
```
**Uso de computadora para fines educativos.** Finalmente, el uso de computadora para fines educativos también muestra un efecto positivo, como ilustra la línea que modela la relación logros-uso, aunque el efecto parece menos marcado que el de las actividades recreativas.  Como mencionamos previamente, debemos notar que el factor *actividades recreativas* y el factor *uso de computadora para fines educativos* tienen relación potencial con el índice socioeconómico y cultural de los alumnos, entre otras consideraciones.   

```{r echo=F,messages=F,warnings=F}		
# load sexto grado puntajes		
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)		
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)		
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)			
		
pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]		
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]		
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]		
		
# merge matematica, lectura y ciencias		
pm6$tipo <- 'matemática'		
pl6$tipo <- 'lectura'		
pc6$tipo <- 'ciencias'		
p6 <- rbind.fill(pm6,pl6,pc6)		
		
p6 <- p6[p6$country == 'PAN',]		
		
# load factores familia		
qa <- read.spss('./data/Alumnos/QA6.SAV', to.data.frame=T)		
qa <- qa[qa$country == 'PAN',]		
		
pest <- merge(p6,qa,by='idstud')		
```		
```{r puntaje_alumno_PCEDUCA6, fig.width=12, fig.height=10, echo=F, message=F, warning=F}		
ggplot(pest, aes(x=PCEDUCA6,y=puntaje_estandar,group=1,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm",  se = F) + xlab("Índice de uso de computador educativo") + ylab("Puntaje de los alumnos")	+  ggtitle('Figura 6.10. Logros de aprendizaje según uso de computadora para fines educativos') + scale_y_continuous(limits=c(200,1200)) + scale_color_discrete(name="Área")
```		

**Invitación al debate nacional.** Existen muchos otros factores y datos de interés en la base de datos de resultados del Terce.  El objetivo principal de este documento ha sido provocar un debate nacional sobre la eficacia de nuestra educación y su impacto potencial en la equidad social.  Aspiramos a contribuir con esto a una cultura de información autocrítica, capaz de aprender con base en evidencias y alcanzar un bienestar sostenible para todo el país.   
