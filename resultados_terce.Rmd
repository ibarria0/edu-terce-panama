```{r init,results="hide",echo=F, message=F, warning=F}
library(foreign)
library(scales)
library(ggplot2)
library(plyr)

source('multiplot.R')
```
## Presentación de resultados del Tercer Estudio Regional Comparativo y Explicativo (TERCE) del Laboratorio Latinoamericano de Evaluación de la Calidad de la Educación (LLECE)

### 1. Resumen

Hay grandes diferencias de oportunidades para nuestra niñez en materia educativa.   La prueba Terce está diseñada para evaluar mediante el puntaje obtenido los logros educativos de los estudiantes.    

Las diferencias de logros educativos desafortunadamente reflejan en forma marcada las diferencias socioeconómicas y culturales, representada en la prueba Terce por un índice socioeconómico  y cultural que sintetiza factores materiales y culturales del alumno y su entorno.  Idealmente, nuestro sistema educativo debería darle las mismas oportunidades de aprendizaje a nuestras niñas y niños independientemente de su nivel socioeconómico y cultural.    

Las escuelas particulares mostraron mayor desempeño que las oficiales; y entre las oficiales, muchas no logran el mínimo nivel de desempeño adecuado, especialmente entre las rurales.     

[JEV2IBG: favor intentar incluir líneas que muestren el promedio y los cambios entre un nivel de aprendizaje y otro]
[JEV2IBG: la grafica debe tener como titulo "logros de aprendizaje de escuelas particulares y oficiales, urbanas y rurales]
[JEV2IBG: es importante y buena práctica que cada figura tenga un número (ej. "Figura 1.1") para facilitar referencias]  [JEV2IBG: Además, si la línea con número de figura permite texto explicativo, me gustaría saber, para agregarlo]


```{r puntaje_isecf_rd, fig.width=12, fig.height=10, echo=F, message=F, warning=F}

# load sexto grado puntajes
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6 <- rbind.fill(pm6,pl6,pc6)
p6$promedio_global <- mean(p6$puntaje_estandar, na.rm=T)
p6$sd_global <- sd(p6$puntaje_estandar, na.rm=T)

p6 <- p6[p6$country == 'PAN',]

# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Publico","Privado")
levels(qd$ruralidad) <- c("Urbano","Rural")

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]
qf <- qf[,c("idschool","idstud","ISECF","INVOLUCF","CSOCBARF","SUPERVF","RECREAF","SERVBARF","VIOLBARF","MOTIVALF","subsgobf","padindig","madindig","DQFIT01","DQFIT25","DQFIT31","DQFIT34","DQFIT15_07","DQFIT18_02")]

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Privado') { return(0) } else if (r == 'Urbano' & d == 'Publico') { return(1) } else if (r == 'Rural' & d == 'Privado') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_isecf_school <- aggregate(ISECF ~ idschool, qf, mean)
m <- merge(mean_school, mean_isecf_school, by=c('idschool'))

ggplot(m, aes(x=ISECF,y=puntaje_estandar,color=rd,size=totalum)) + geom_point(alpha=0.7) + stat_smooth(method=lm,se=F) + scale_size(guide=FALSE) + xlab("Índice de estatus socioeconómico y cultural") + ylab("Puntaje Promedio por Escuela")
```

A pesar de las grandes diferencias, algunas escuelas oficiales rurales con bajo índice socioeconómico y cultural logran resultados superiores al promedio internacional e iguales al de las mejores escuelas oficiales urbanas.   Esas escuelas podrían aportarnos lecciones sobre como mejorar el desempeño de otras escuelas.   

En cuanto al desempeño comparativo, la figura siguiente [para sexto grado] es representativa y confirma la tendencia conocida de que países con mayor ingreso per cápita obtienen mejores puntajes promedio; sin embargo Panamá obtiene resultados por debajo de lo esperado.  Estos resultados son consistentes con otras pruebas internacionales en las que ha participado Panamá (pruebas Serce 2006 y Pisa 2009). Panamá puede y debe mejorar significativamente su desempeño.    

[JEV2IBG: cambiar el título de la figura por "Puntaje promedio según producto (PIB) per cápita por país, sexto grado"]
[JEV2IBG: corregir la P mayúscula de "país" en el título]
[JEV2IBG: cambiar la leyenda del eje X por "Producto (PIB) per cápita"]  
[JEV2IBG: agregar tílde en "Capita" en la leyenda del eje X]


```{r puntaje_gdp, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6 <- rbind.fill(pm6,pl6,pc6)


gdp <- read.csv('./data/suplemental/gdp.csv')
names(gdp) <- c("Country_Name","country","gdp_2013")
m <- merge(p6,gdp,by="country")
a <- aggregate( puntaje_estandar ~ country + gdp_2013, m, mean)
ggplot(a, aes(x=gdp_2013, y=puntaje_estandar, fill=country, color=country, group=1)) + geom_point() + stat_smooth(method=lm, se=F) + geom_text(aes(label=country)) + xlab("Ingreso per Capita") + ylab("Puntaje Promedio") + ggtitle("Puntaje promedio según ingreso per cápita por Pais (sexto grado)") + scale_x_continuous(label=dollar)

```

### 2. Introduccion 


La educación es el gran nivelador… en empleo, aceptación social, valerse por si mismos…

Es posible evaluar de forma científica, es decir, de forma confinable….   Una cultura que valora información permite aprender y avanzar…

Terce cubre extensamente la región de América Latina, con pocas excepciones.  No incluye al Caribe...

Pruebas estandarizadas pueden ser criticadas desde varios angulos… pero son útiles y mucho mejor que avanzar a oscuras.   

Usar para aprender, no para criticar.   

no se va a poder explicar por region geografica

Minimizamos las interpretaciones porque las mismas necesitan estudios y validaciones rigurosas.  Más bien esta divulgación es una invitación a todos los especialistas e interesados a anaizar los resultados disponibles, con la responsabilidad de rigor implicita en el estudio y divulgación de resultados sociales.   

Esta es la segunda divulgación en torno al Terce.   Previamente, en diciembre 2014, Unesco y Meduca [VERIFICAR] divulgaron aspectos sobresalientes de la comparación de resultados entre el Serce, 2006, y el Terce, 2013. Por supuesto, tanto los resultados sujeto de esta divulgación como los anteriores del Terce (2013), Pisa (2009), Sineca ([2008?]) y Serce (2006) deben continuar bajo análisis para mayor comprensión y divulgación.   

 

### 3. La prueba Terce y participación de Panamá
#### 3.1 Qué es la evaluación Terce

Llece es un laboratorio latinoamericano con base en chile.  Administra evaluaciones comparativas y explicativas de las cuales el terce [tercer…] es la tercera….

Evaluar logros de aprendizaje usando metodos de ciencia empirica para poder comparar paises, regions y grupos y para intentar entender los factores que explican los resultados.  

La muestra se diseña segun las preguntas de interes para asegurar que la muestra es suficientemente representative para lograr estadisticas confiables.    Hay factores asociados de interes para todos y comparaciones entre grupos de interes para cada pais.  Panama pidio genero, originarios, areas de conocimiento y …

Todos los países ded América Latina participaron con la excepción de Cuba[, y otros?].   También participó el estado de Nuevo León, México, como en la prueba Serce 2006.  

La evaluación cubrió matemáticas y lectura para 3ero y 6 grado, ciencias para 6to grado y una prueba especial de escritura en 6to grado.   [JEV2JEV: averiguar de esa ultima.  No me queda clara.]

#### 3.2 Características de las escuelas y alumnos participantes de Panamá

[NUMERO DE ESCUELAS] participaron en la prueba Terce representando cuatro tipos de escuela así:  oficial urbana [No. OFC URB], oficial rural [No. OFC RRL], particular urbana [No. PRT URB], particular rural [No. PRT RRL].  En el total de escuelas, 3775 estudiantes correspondían a sexto grado y 3631 estudiantes a tercer grado.

[JEV2IBG: usar cómo título "Distribución de escuelas por sector escolar"]
[JEV2IBG: usar color azul para las barras en lugar de negro]
[JEV2IBG: intentar barras más angostas en relación con el ancho de la figura: pienso que se ve "pesada"]
[JEV2IBG: cambiar etiqueta de las barras por "Oficial" y "Particular", en lugar de "Publico" y "Privado"]
[JEV2IBG: cambiar "dependencia" por "Sector escolar". Notar que por consistencia empieza con mayúscula]


```{r demo_pub_priv, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(ruralidad ~ dependencia, qd, length)
ggplot(a, aes(x=dependencia, y=ruralidad)) + geom_bar(stat="identity") + ylab("Cantidad de Escuelas")
```

[JEV2IBG: usar cómo título "Distribución de escuelas por ruralidad]
[JEV2IBG: En la siguiente gráfica usar mayúscula inicial en "ruralidad"]
[JEV2IBG: usar color azul para las barras en lugar de negro]
[JEV2IBG: intentar barras más angostas en relación con el ancho de la figura: pienso que se ve "pesada"]

```{r demo_ruralidad, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(dependencia ~ ruralidad, qd, length)
ggplot(a, aes(x=ruralidad, y=dependencia)) + geom_bar(stat="identity") + ylab("Cantidad de Escuelas")
```
Las escuelas participantes de Panamá están principalmente concentradas en el promedio del índice socioeconómico y cultural (0.0) de toda la región latinoamericana, en cuanto el índice promedio de sus alumnos.  

[JEV2IBG: En la siguiente gráfica (distribucion isec por pais) mostrar solo CHL, PAN, NIC, para simplificar]
[JEV2IBG: Usar título "Concentración de escuelas (distribución) según índice socioeconómico y cultural para tres países de la prueba.] 
[JEV2IBG: cambiar "ISECF" en la leyenda por "Índice socioeconómico y cultural"]

```{r demo_isecf, fig.width=12, fig.height=20, echo=F, message=F, warning=F}

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
ggplot(qf, aes(x=ISECF)) + geom_histogram() + ylab("Cantidad de Escuelas") + facet_grid(country ~ ., scales='free_y') + scale_y_continuous(breaks=NULL) + geom_vline(x=0, colour="red", linetype = "longdash")
```
Las dos figuras siguientes muestran la cantidad de estudiantes participantes por edad en tercer grado y sexto grado.  

[JEV2IBG: supongo que la siguiente grafica es de 6to grado.  falta 3er grado? Incluirla primero]

[JEV2IBG: usar como título "Número de estudiantes de sexto grado por edad"]
[JEV2IBG: cambiar en la leyenda del eje X "DQA6IT01" por "Edad"]
[JEV2IBG: eliminar en la leyenda del margen derecho la etiqueta "DQA6IT01"]

```{r demo_genero_edad, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
qa6 <- read.spss('./data/Alumnos/QA6.SAV', to.data.frame=T)
qa6 <- qa6[qa6$country == 'PAN',]
qa6$DQA6IT01 <- as.factor(qa6$DQA6IT01)
qa6$DQA6IT02 <- as.factor(qa6$DQA6IT02)

ggplot(qa6, aes(x=DQA6IT01, fill=DQA6IT02)) + geom_histogram(alpha=.5, position="dodge") + scale_x_discrete(labels=c("10 años o menos","11 años","12 años", "13 años", "14 años", "15 años o mas", "NA")) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + scale_fill_discrete(labels=c("Niña","Niño")) + ylab("Cantidad de Estudiantes")
```
[GENERO PORCENTAJE FEM]% de los alumnos indicó ser niña y  [GENERO PORCENTAJE N/A]% no contestó o no supo responder.    

[JEV2IBG: en los datos salen cuantos son realmente niñas y niños?   ...los lectores se preguntarán porqué no sabemos la cifra exacta si son estudiantes de Meduca.]
[JEV2IBG: incluir título "Respuesta a la pertenencia de género"]
[JEV2IBG: podríamos usar porcentajes en el eje Y en lugar de cantidad?]
[JEV2IBG: usar color azul para las barras en lugar de negro]
[JEV2IBG: intentar barras más angostas en relación con el ancho de la figura: pienso que se ve "pesada"]

```{r demo_genelaro, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
qa6 <- read.spss('./data/Alumnos/QA6.SAV', to.data.frame=T)
qa6 <- qa6[qa6$country == 'PAN',]
qa6$DQA6IT02 <- as.factor(qa6$DQA6IT02)
levels(qa6$DQA6IT02) <- c("Niña","Niño")

ggplot(qa6, aes(x=DQA6IT02)) + geom_histogram(alpha=.5, position="dodge")  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Cantidad de Estudiantes") + xlab("¿Eres niña o niño?")
```
[ORGNR PORCENTAJE AFIRMATIVO]% de los alumnos indicó pertenecer a alguna etnia "originaria" y [ORGNR PORCENTAJE N/A]% no contestó o no supo responder.   

[JEV2IBG: incluir título "Respuesta a la pertenencia de etnia originaria"]
[JEV2IBG: podríamos usar porcentajes en el eje Y en lugar de cantidad?]
[JEV2IBG: agregar tílde al término "índigena" en la leyenda del eje X]
[JEV2IBG: usar color azul para las barras en lugar de negro]
[JEV2IBG: intentar barras más angostas en relación con el ancho de la figura: pienso que se ve "pesada"]

```{r etnia, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
qa6 <- read.spss('./data/Alumnos/QA6.SAV', to.data.frame=T)
qa6 <- qa6[qa6$country == 'PAN',]
qa6$DQA6IT06 <- as.factor(qa6$DQA6IT06)
levels(qa6$DQA6IT06) <- c("No","Si")

ggplot(qa6, aes(x=DQA6IT06)) + geom_histogram(alpha=.5, position="dodge")  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Cantidad de Estudiantes") + xlab("¿Perteneces a alguna etnia indígena?")

```


## 4. Comparacion con America Latina
### 4.1 Puntaje vs ingreso per capita (3er grado, 6to grado)

Comparar resultados entre países es útil pero no lo principal. Es un error considerar la evaluación Terce como una competencia por el mayor puntaje promedio.   Sus resultados son sólo parte de la evidencia e información de cuánto logran aprender los alumnos.  Su valor principal está en intentar comprender qué acciones se pueden tomar para que la educación le de las mejores oportunidades de vida a los alumnos y países.   

Entre los países participantes Chile obtuvo el mejor resultado seguido de Costa Rica y México.  Costa Rica sirve de ejemplo que un país de escala y ubicación como la nuestra puede obtener mejores resultados.     Las figuras [NO. 3ero PTJ VS PIB/CAP] Y [NO. 6ero PTJ VS PIB/CAP] siguientes muestran que Panamá obtiene resulados inferiores a lo esperado para su producto interno bruto per cápita.  Estos resultados son consistentes con otras pruebas internacionales en las que ha participado Panamá (pruebas Serce 2006 y Pisa 2009). El efecto es más pronunciado para sexto grado que para tercer grado.   Parece razonable esperar que con la prioridad social necesaria, la riqueza nacional nos permita lograr al menos los resultados esperados.   

[JEV2IBG: Repetir la figura 2 arriba pero para los resultados de tercer grado primero]
[JEV2IBG: título "Puntaje promedio según producto (PIB) per cápita por país, tercer grado"]
[JEV2IBG: verificar p minúscula y tílde en "país" en el título]
[JEV2IBG: verificar que la leyenda del eje X dice "Producto (PIB) per cápita" y tílde en "cápita"]  

[JEV2IBG: Repetir la figura 2 (sexto grado)]
[JEV2IBG: título "Puntaje promedio según producto (PIB) per cápita por país, sexto grado"]
[JEV2IBG: verificar p minúscula y tílde en "país" en el título]
[JEV2IBG: verificar que la leyenda del eje X dice "Producto (PIB) per cápita" y tílde en "cápita"]  

### 4.2 Desempeño en logros de aprendizaje

Más relevante en primera instancia es saber si nuestros niños y niñas logran un aprendiza útil para su propio bienestar y la prosperidad de la nación. La evaluación Terce define cuatro niveles de logros de aprendizaje.  El nivel 1 se considera insuficiente preparación y el nivel 4 la mejor preparación educativa para la vida esperada de los participantes.  Corresponden a dominios progresivamente más eficaces del área de conocimiento y están explicados en el apéndice [No. APENDICE NIVELES].  

[22?]% de nuestras niñas y niños muestran un logro de aprendizaje en el nivel inferior, o nivel 1, considerado inadecuado como preparación para su vida.   Para ciencias son [45?]% y para matemáticas [65?]%.   La figura [No. NIVELES] muestra como se comparan los porcentajes de alumnos de Panamá para cada nivel con los del resto de los alumnos de otros países. 

[JEV2IBG: título "Niveles de logros de aprendizaje por área de conocimiento, comparados"]
[JEV2IBG: cambiar la leyenda del eje Y a "Porcentaje de alumnos"]
[JEV2IBG: cambiar la leyenda del eje X a "Niveles de logro de aprendizaje"]
[JEV2IBG: verificar que las leyendas del eje X y Y empiezan con mayúscula]
[JEV2IBG: eliminar del margen derecho la etiqueta "countryp"]
[JEV2IBG: si es posible, usar colores menos intensos para las barras, especialmente el rojo (asusta ;)]

```{r niveles_barcharts, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'

p6 <- rbind.fill(pm6,pl6,pc6)
p6$grado <- '6'

pm3 <- read.spss('./data/Puntajes_Alumnos/PM3_all_TERCE.sav', to.data.frame=T)
pl3 <- read.spss('./data/Puntajes_Alumnos/PL3_all_TERCE.sav', to.data.frame=T)

pm3$tipo <- 'matematica'
pl3$tipo <- 'lectura'

p3 <- rbind.fill(pm3,pl3)

p3$grado <- '3'

p <- rbind.fill(p6,p3)

ispan <- function(x) { if(x == 'PAN') { return("PAN") } else { return("OTROS") } }
p$countryp <- sapply(p$country,ispan)
a <- aggregate(puntaje_estandar ~ nivel + countryp + tipo + grado, p, length)
calc_percent <- function(c,t,g,x) { return(100*(x/sum(a[a$countryp == c & a$tipo == t & a$grado == g,]$puntaje_estandar))) }
a$dist <- mapply(calc_percent, a$countryp, a$tipo, a$grado, a$puntaje_estandar)

#####
ggplot(a[a$grado == 6,], aes(x=nivel,y=dist,fill=countryp)) + geom_bar(stat="identity", position=position_dodge(), colour="black") + ggtitle("Cantidad de Estudiantes por Nivel (6to Grado)") + facet_grid(tipo ~ .) + scale_fill_brewer(palette="Set1")
```
   
## 5 Comparacion del desempeño en el Terce (2013?) con el Serce (2006)
### 5.1 Mejora en relación con los resultados serce, por materia

[JEV2IBG: Al final, Gina dice que este informe debe ser solo del Terce.  Incluí texto referente al serce en la introducción.  Por tanto Eliminaremos esta seccion y correremos las secciones 6 en adelante.]    

```{r serce_terce, fig.width=12, fig.height=6, echo=F, message=F, warning=F}
library(stringr)
library(scales)

a <- aggregate(puntaje_estandar ~  tipo, p6, length)
a_nivel_terce <- aggregate(puntaje_estandar ~ nivel + tipo, p6, length)
a_nivel_terce$percent_estudiantes <- 0

a_nivel_terce[a_nivel_terce$tipo == 'lectura',]$percent_estudiantes <- a_nivel_terce[a_nivel_terce$tipo == 'lectura',]$puntaje_estandar / a[a$tipo == 'lectura',]$puntaje_estandar
a_nivel_terce[a_nivel_terce$tipo == 'matematica',]$percent_estudiantes <- a_nivel_terce[a_nivel_terce$tipo == 'matematica',]$puntaje_estandar / a[a$tipo == 'matematica',]$puntaje_estandar
a_nivel_terce[a_nivel_terce$tipo == 'ciencias',]$percent_estudiantes <- a_nivel_terce[a_nivel_terce$tipo == 'ciencias',]$puntaje_estandar / a[a$tipo == 'ciencias',]$puntaje_estandar

#serce
sm6 <- read.spss('./data/serce/m6.sav', to.data.frame=T)
sc6 <- read.spss('./data/serce/c6.sav', to.data.frame=T)
sl6 <- read.spss('./data/serce/l6.sav', to.data.frame=T)

sm6 <- sm6[,c("id_alumno","PUNTAJE_ESTANDAR_FINAL","nivel","AdmRur","pais_num")]
sl6 <- sl6[,c("id_alumno","PUNTAJE_ESTANDAR_FINAL","nivel","AdmRur","pais_num")]
sc6 <- sc6[,c("id_alumno","PUNTAJE_ESTANDAR_FINAL","nivel","AdmRur","pais_num")]

sm6$tipo <- 'matematica'
sl6$tipo <- 'lectura'
sc6$tipo <- 'ciencias'
s6 <- rbind.fill(sm6,sl6,sc6)
s6 <- s6[s6$pais_num == "Panam\xe1",]
s6[s6$nivel == 'Debajo de I',]$nivel <- "I"

a <- aggregate(PUNTAJE_ESTANDAR_FINAL ~ tipo, s6, length)
a_nivel_serce <- aggregate(PUNTAJE_ESTANDAR_FINAL ~ nivel + tipo, s6, length)

a_nivel_serce$percent_estudiantes <- 0

a_nivel_serce[a_nivel_serce$tipo == 'lectura',]$percent_estudiantes <- a_nivel_serce[a_nivel_serce$tipo == 'lectura',]$PUNTAJE_ESTANDAR_FINAL / a[a$tipo == 'lectura',]$PUNTAJE_ESTANDAR_FINAL
a_nivel_serce[a_nivel_serce$tipo == 'matematica',]$percent_estudiantes <- a_nivel_serce[a_nivel_serce$tipo == 'matematica',]$PUNTAJE_ESTANDAR_FINAL / a[a$tipo == 'matematica',]$PUNTAJE_ESTANDAR_FINAL
a_nivel_serce[a_nivel_serce$tipo == 'ciencias',]$percent_estudiantes <- a_nivel_serce[a_nivel_serce$tipo == 'ciencias',]$PUNTAJE_ESTANDAR_FINAL / a[a$tipo == 'ciencias',]$PUNTAJE_ESTANDAR_FINAL


a_nivel_terce$nivel <- str_trim(as.character(a_nivel_terce$nivel))
a_nivel_serce$nivel <- str_trim(as.character(a_nivel_serce$nivel))
a_nivel_serce$examen <- 'serce'
a_nivel_terce$examen <- 'terce'

a_nivel <- rbind.fill(a_nivel_serce,a_nivel_terce)


a_nivel$nivel <- as.factor(a_nivel$nivel)
a_nivel$examen <- as.factor(a_nivel$examen)
levels(a_nivel$examen) <- c('2006','2013')

ggplot(a_nivel, aes(x=nivel, y=percent_estudiantes, fill=examen)) + geom_bar(stat='identity', position="dodge") + scale_y_continuous(labels = percent) + facet_grid( . ~ examen) + xlab('') + ylab('') + ggtitle('Porcentaje de Estudiantes por Nivel (Panama)') + facet_grid( . ~ tipo )
```

```{r serce_terce_2, fig.width=12, fig.height=6, echo=F, message=F, warning=F}
ggplot(a_nivel, aes(x=examen, y=percent_estudiantes, fill=nivel)) + geom_bar(stat='identity') + scale_y_continuous(labels = percent) + facet_grid( . ~ examen) + xlab('') + ylab('') + ggtitle('Porcentaje de Estudiantes por Nivel (Panama)') + facet_grid( . ~ tipo )
```

## 6 Características de los resultados en Panamá
### 6.1 Logros por Genero 

Las niñas obtuvieron mejores resultados que los niños en lectura de tercer grado, sexto grado y en ciencias de sexto grado. En matemáticas, aunque las niñas obtuvieron mejor resultado, la diferencia es tan pequeña que no permite afirmar que sus logros de aprendizaje son mejores.   

Las figuras [No. PTJ POR GNR] y [No. STD DEV GNR] comparan los puntajes promedio obtenidos por cada género, la primera, y la diferencia entre niños y niñas, la segunda, expresada en desviaciones estándar 

[JEV2IBG: La figura de desviacion estandar quisiera conversarla, porque la comparacion deberia ser una sola barra.  La barra indicaría la diferencia entre los puntajes de cada género expresado en desviaciones estandar.]
[JEV2IBG: como procesaste aquellos que respondieron N/A]


[JEV2IBG: título "Puntaje promedio comparado entre géneros"]
[JEV2IBG: cambiar la leyenda del eje Y a "Puntaje promedio"]
[JEV2IBG: cambiar la leyenda del eje X a "Género"] 
[JEV2IBG: eliminar del margen derecho la etiqueta "DQASIT02"] 

```{r demo_genero_puntaje, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
qa6 <- read.spss('./data/Alumnos/QA6.SAV', to.data.frame=T)
qa6 <- qa6[qa6$country == 'PAN',]
qa6$DQA6IT02 <- as.factor(qa6$DQA6IT02)

genero <- merge(p6,qa6,by='idstud')
a <- aggregate(puntaje_estandar ~ DQA6IT02, genero, mean)
a$dif <- (a$puntaje_estandar - mean(p6$puntaje_estandar,na.rm=T))/sd(p6$puntaje_estandar,na.rm=T)
levels(a$DQA6IT02) <- c("Niña","Niño")

ggplot(a, aes(x=DQA6IT02,y=puntaje_estandar,fill=DQA6IT02)) + geom_bar(stat='identity')
```
[JEV2IBG: título "Diferencia diminuta de puntaje promedio a favor de las niñas"]
[JEV2IBG: esta gráfica debería ser una sola barra de valores positivos a favor de las niñas, indicando la diferencia entre el puntaje de niñas menos el de niños expresada en desviaciones estándar]
[JEV2IBG: cambiar la leyenda del eje Y a "Desviaciones estandar"]
[JEV2IBG: cambiar la leyenda del eje X a "Diferencia"] 
[JEV2IBG: eliminar del margen derecho la etiqueta "DQASIT02"] 

```{r demo_genero_puntaje_desv, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(a, aes(x=DQA6IT02,y=dif,fill=DQA6IT02)) + geom_bar(stat='identity') + ggtitle('Standard Deviation from Mean')
```

### 6.2 Logros de grupos originarios

Los alumnos que se reconocen como miembros de etnias originarias logran menor puntaje que los que no se consideran miembros.  Las figuras [No. PTJ POR ETN] y [No. STD DEV ETN] comparan los puntajes promedio y diferencia según si la alumna o alumno se reconoce o no como miembro de grupos originarios.    

[JEV2IBG: título "Puntaje promedio comparado según pertenencia a grupos originarios"]
[JEV2IBG: cambiar la leyenda del eje Y a "Puntaje promedio"]
[JEV2IBG: cambiar "DQA6IT06" en la leyenda del eje X por "Etnia"] 
[JEV2IBG: cambiar las etiquetas en el eje X por "No originarios" y "Originarios"]
[JEV2IBG: eliminar del margen derecho la etiqueta "DQA6IT06"] 
[JEV2IBG: como procesaste aquellos que respondieron N/A]

```{r demo_etnia_puntaje, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
qa6 <- read.spss('./data/Alumnos/QA6.SAV', to.data.frame=T)
qa6 <- qa6[qa6$country == 'PAN',]
qa6$DQA6IT06 <- as.factor(qa6$DQA6IT06)

genero <- merge(p6,qa6,by='idstud')
a <- aggregate(puntaje_estandar ~ DQA6IT06, genero, mean)
a$dif <- (a$puntaje_estandar - mean(p6$puntaje_estandar,na.rm=T))/sd(p6$puntaje_estandar,na.rm=T)
levels(a$DQA6IT06) <- c("No Indigena","Etnia Indigena")

ggplot(a, aes(x=DQA6IT06,y=puntaje_estandar,fill=DQA6IT06)) + geom_bar(stat='identity')
```
[JEV2IBG: título "Diferencia de puntaje promedio desfavorece a los grupos originarios"]
[JEV2IBG: esta gráfica debería ser una sola barra de valores negativos en contra  de los grupos originarios, indicando la diferencia entre el puntaje de originarios menos el de los no originarios expresada en desviaciones estándar]
[JEV2IBG: cambiar la leyenda del eje Y a "Desviaciones estandar"]
[JEV2IBG: cambiar la leyenda del eje X a "Diferencia"] 
[JEV2IBG: eliminar del margen derecho la etiqueta "DQA6IT06"] 

```{r demo_etnia_puntaje_desv, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(a, aes(x=DQA6IT06,y=dif,fill=DQA6IT06)) + geom_bar(stat='identity') + ggtitle('Standard Deviation from Mean')
```
Adicionalmente, el índice socioeconómico y cultural muestra menor relación con el puntaje promedio obtenido para alumnos que se consideran miembros de grupos originarios que para aquellos que no.   Esto lo ilustra la figura [No. PTJ VS ISECF ORGN] en la que cada línea muestra la correspondencia entre puntaje promedio obtenido y el índice del alúmno.  La diferencia de puntaje entre alumnos de menor y mayor índices es más pronunciada para alumnos que se declaran no originarios.  

[JEV2IBG: título "Relación entre logros e índice socioeconómico y cultural según etnia"]
[JEV2IBG: cambiar la leyenda del eje Y a "Puntaje promedio"]
[JEV2IBG: cambiar la leyenda del eje X a "Índice socioeconómico y cultural"] 
[JEV2IBG: eliminar del margen derecho la etiqueta "DQA6IT06"] 

```{r demo_etnia_puntaje_isecf, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
# load factores familia

qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]
qf <- qf[,c("idstud","ISECF")]

g <- merge(genero,qf,by='idstud')

levels(g$DQA6IT06) <- c("No Indigena","Etnia Indigena")
ggplot(g[!is.na(g$DQA6IT06),], aes(x=ISECF,y=puntaje_estandar,color=DQA6IT06)) + geom_point(alpha=0.0) + stat_smooth(method=lm,se=F)
```
### 6.3 Logros según tipo de escuela

Las oportunidades de educación y salud muestran un altísimo grado de influencia en el bienestar de un individuo. Cuándo los logros de aprendizaje dependen marcadamente del poder adquisitivo de una persona es difícil argumentar que la sociedad brinda oportunidades justas a todos sus residentes.  En Panamá, la diferencia de logros entre escuelas particulares, escuelas oficiales urbanas y escuelas oficiales rurales es muy marcada.   

Las figuras [No. PTJ VS ISEC 3ero] y [No. PTJ VS ISEC 6to] muestran para cada escuela participante de Panamá el puntaje promedio obtenido por sus alumnos en el eje vertical y el índice socioeconómico y cultural promedio de sus alumnos en el eje horizontal. Las líneas representan el puntaje promedio de alumnos de todos los países, incluyendo Panamá, en la prueba Terce y el puntaje debajo del cual se define el nivel 1 de aprendizaje, considerado inadecuado para las situaciones de vida esperadas. [PORCENTAJE NIVEL 1]% de las niñas y niños obtuvieron puntajes correspondientes al nivel 1.   

[JEV2IBG: las 2 figuras aqui son las versiones de 3ero y 6to grado de la figura 1 en el resumen ejecutivo]
[JEV2IBG: Pregunta: las figuras de puntaje vs isec por escuela pueden indcar un solo puntaje para definir el nivel 1 de todas las áreas de conocimiento, o el puntaje que define el nivel 1 cambia de área a área]

Una observación de suma importancia es que hay un grupo de escuelas oficiales rurales cuyos logros promedio son iguales o superiores a los de las escuelas oficiales urbanas a pesar de tener índices socioeconómicos y culturales menores en promedio. Estas escuelas probablemente tienen lecciones que aportar en cuanto a cómo mejorar los logros educativos en las áreas menos favorecidas del país.    

[JEV2IBG: titulo "logros de aprendizaje de escuelas particulares y oficiales, urbanas y rurales, tercer grado]
[JEV2IBG: cambiar la leyenda del eje Y a "Puntaje promedio"]
[JEV2IBG: cambiar la leyenda del eje X a "Índice socioeconómico y cultural"]
[JEV2IBG: intentar incluir los niveles de aprendizaje, o al menos el nivel 1]

[JEV2IBG: titulo "logros de aprendizaje de escuelas particulares y oficiales, urbanas y rurales, sexto grado]
[JEV2IBG: cambiar la leyenda del eje Y a "Puntaje promedio"]
[JEV2IBG: cambiar la leyenda del eje X a "Índice socioeconómico y cultural"]
[JEV2IBG: intentar incluir los niveles de aprendizaje, o al menos el nivel 1]

## 7 Relacion entre desempeño y factores típicamente asociados al proceso de aprendizaje
## 7.1 Que son factores asociados

Son factores selectos que plausiblemente podrian mostrar relación con los logros de aprendizaje.  El que muestren relación no significa por si solo que sea garantía ni incluso causa de los logros; pero sugiere que es conveniente explorar la relación.   

## 7.2 Logros según nivel socioeconómico y cultural

```{r puntaje_INFRAD, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
# load sexto grado puntajes
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6 <- rbind.fill(pm6,pl6,pc6)
p6$promedio_global <- mean(p6$puntaje_estandar, na.rm=T)
p6$sd_global <- sd(p6$puntaje_estandar, na.rm=T)

p6 <- p6[p6$country == 'PAN',]

# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Publico","Privado")
levels(qd$ruralidad) <- c("Urbano","Rural")

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]
qf <- qf[,c("idschool","idstud","ISECF","INVOLUCF","CSOCBARF","SUPERVF","RECREAF","SERVBARF","VIOLBARF","MOTIVALF","subsgobf","padindig","madindig","DQFIT01","DQFIT25","DQFIT31","DQFIT34","DQFIT15_07","DQFIT18_02")]

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Privado') { return(0) } else if (r == 'Urbano' & d == 'Publico') { return(1) } else if (r == 'Rural' & d == 'Privado') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_infrad_school <- aggregate(INFRAD ~ idschool, qd, mean)
m <- merge(mean_school, mean_infrad_school, by=c('idschool'))

ggplot(m, aes(x=INFRAD,y=puntaje_estandar)) + geom_point(alpha=0.7) + stat_smooth(method=lm,se=F) + scale_size(guide=FALSE) + xlab("Índice de infraestructura de la escuela") + ylab("Puntaje Promedio por Escuela")
```

```{r puntaje_INFRAD_rd, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
# load sexto grado puntajes
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6 <- rbind.fill(pm6,pl6,pc6)
p6$promedio_global <- mean(p6$puntaje_estandar, na.rm=T)
p6$sd_global <- sd(p6$puntaje_estandar, na.rm=T)

p6 <- p6[p6$country == 'PAN',]

# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Publico","Privado")
levels(qd$ruralidad) <- c("Urbano","Rural")

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Privado') { return(0) } else if (r == 'Urbano' & d == 'Publico') { return(1) } else if (r == 'Rural' & d == 'Privado') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_infrad_school <- aggregate(INFRAD ~ idschool, qd, mean)
m <- merge(mean_school, mean_infrad_school, by=c('idschool'))

ggplot(m, aes(x=INFRAD,y=puntaje_estandar,color=rd)) + geom_point(alpha=0.7) + stat_smooth(method=lm,se=F) + scale_size(guide=FALSE) + xlab("Índice de infraestructura de la escuela") + ylab("Puntaje Promedio por Escuela")
```


```{r puntaje_VIOLEND, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
# load sexto grado puntajes
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6 <- rbind.fill(pm6,pl6,pc6)
p6$promedio_global <- mean(p6$puntaje_estandar, na.rm=T)
p6$sd_global <- sd(p6$puntaje_estandar, na.rm=T)

p6 <- p6[p6$country == 'PAN',]

# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Publico","Privado")
levels(qd$ruralidad) <- c("Urbano","Rural")

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]
qf <- qf[,c("idschool","idstud","ISECF","INVOLUCF","CSOCBARF","SUPERVF","RECREAF","SERVBARF","VIOLBARF","MOTIVALF","subsgobf","padindig","madindig","DQFIT01","DQFIT25","DQFIT31","DQFIT34","DQFIT15_07","DQFIT18_02")]

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Privado') { return(0) } else if (r == 'Urbano' & d == 'Publico') { return(1) } else if (r == 'Rural' & d == 'Privado') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_infrad_school <- aggregate(VIOLEND ~ idschool, qd, mean)
m <- merge(mean_school, mean_infrad_school, by=c('idschool'))

ggplot(m, aes(x=VIOLEND,y=puntaje_estandar)) + geom_point(alpha=0.7) + stat_smooth(method=lm,se=F) + scale_size(guide=FALSE) + xlab("Índice de violencia en el entorno de la escuela") + ylab("Puntaje Promedio por Escuela")
```

```{r puntaje_VIOLEND_rd, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
# load sexto grado puntajes
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6 <- rbind.fill(pm6,pl6,pc6)
p6$promedio_global <- mean(p6$puntaje_estandar, na.rm=T)
p6$sd_global <- sd(p6$puntaje_estandar, na.rm=T)

p6 <- p6[p6$country == 'PAN',]

# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Publico","Privado")
levels(qd$ruralidad) <- c("Urbano","Rural")

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Privado') { return(0) } else if (r == 'Urbano' & d == 'Publico') { return(1) } else if (r == 'Rural' & d == 'Privado') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_infrad_school <- aggregate(VIOLEND ~ idschool, qd, mean)
m <- merge(mean_school, mean_infrad_school, by=c('idschool'))

ggplot(m, aes(x=VIOLEND,y=puntaje_estandar,color=rd)) + geom_point(alpha=0.7) + stat_smooth(method=lm,se=F) + scale_size(guide=FALSE) + xlab("Índice de violencia en el entorno de la escuela") + ylab("Puntaje Promedio por Escuela")
```

```{r puntaje_CSOCIALD, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
# load sexto grado puntajes
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6 <- rbind.fill(pm6,pl6,pc6)
p6$promedio_global <- mean(p6$puntaje_estandar, na.rm=T)
p6$sd_global <- sd(p6$puntaje_estandar, na.rm=T)

p6 <- p6[p6$country == 'PAN',]

# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Publico","Privado")
levels(qd$ruralidad) <- c("Urbano","Rural")

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]
qf <- qf[,c("idschool","idstud","ISECF","INVOLUCF","CSOCBARF","SUPERVF","RECREAF","SERVBARF","VIOLBARF","MOTIVALF","subsgobf","padindig","madindig","DQFIT01","DQFIT25","DQFIT31","DQFIT34","DQFIT15_07","DQFIT18_02")]

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Privado') { return(0) } else if (r == 'Urbano' & d == 'Publico') { return(1) } else if (r == 'Rural' & d == 'Privado') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_infrad_school <- aggregate(CSOCIALD ~ idschool, qd, mean)
m <- merge(mean_school, mean_infrad_school, by=c('idschool'))

ggplot(m, aes(x=CSOCIALD,y=puntaje_estandar)) + geom_point(alpha=0.7) + stat_smooth(method=lm,se=F) + scale_size(guide=FALSE) + xlab("Índice del capital social en el entorno de la escuela") + ylab("Puntaje Promedio por Escuela")
```

```{r puntaje_CSOCIALD_rd, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
# load sexto grado puntajes
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6 <- rbind.fill(pm6,pl6,pc6)
p6$promedio_global <- mean(p6$puntaje_estandar, na.rm=T)
p6$sd_global <- sd(p6$puntaje_estandar, na.rm=T)

p6 <- p6[p6$country == 'PAN',]

# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Publico","Privado")
levels(qd$ruralidad) <- c("Urbano","Rural")

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Privado') { return(0) } else if (r == 'Urbano' & d == 'Publico') { return(1) } else if (r == 'Rural' & d == 'Privado') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_infrad_school <- aggregate(CSOCIALD ~ idschool, qd, mean)
m <- merge(mean_school, mean_infrad_school, by=c('idschool'))

ggplot(m, aes(x=CSOCIALD,y=puntaje_estandar,color=rd)) + geom_point(alpha=0.7) + stat_smooth(method=lm,se=F) + scale_size(guide=FALSE) + xlab("Índice del capital social en el entorno de la escuela") + ylab("Puntaje Promedio por Escuela")
```

```{r puntaje_AUTOADD, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
# load sexto grado puntajes
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6 <- rbind.fill(pm6,pl6,pc6)
p6$promedio_global <- mean(p6$puntaje_estandar, na.rm=T)
p6$sd_global <- sd(p6$puntaje_estandar, na.rm=T)

p6 <- p6[p6$country == 'PAN',]

# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Publico","Privado")
levels(qd$ruralidad) <- c("Urbano","Rural")

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]
qf <- qf[,c("idschool","idstud","ISECF","INVOLUCF","CSOCBARF","SUPERVF","RECREAF","SERVBARF","VIOLBARF","MOTIVALF","subsgobf","padindig","madindig","DQFIT01","DQFIT25","DQFIT31","DQFIT34","DQFIT15_07","DQFIT18_02")]

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Privado') { return(0) } else if (r == 'Urbano' & d == 'Publico') { return(1) } else if (r == 'Rural' & d == 'Privado') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_infrad_school <- aggregate(AUTOADD ~ idschool, qd, mean)
m <- merge(mean_school, mean_infrad_school, by=c('idschool'))

ggplot(m, aes(x=AUTOADD,y=puntaje_estandar)) + geom_point(alpha=0.7) + stat_smooth(method=lm,se=F) + scale_size(guide=FALSE) + xlab("Índice de autonomía administrativa de la escuela") + ylab("Puntaje Promedio por Escuela")
```

```{r puntaje_AUTOADD_rd, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
# load sexto grado puntajes
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6 <- rbind.fill(pm6,pl6,pc6)
p6$promedio_global <- mean(p6$puntaje_estandar, na.rm=T)
p6$sd_global <- sd(p6$puntaje_estandar, na.rm=T)

p6 <- p6[p6$country == 'PAN',]

# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Publico","Privado")
levels(qd$ruralidad) <- c("Urbano","Rural")

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Privado') { return(0) } else if (r == 'Urbano' & d == 'Publico') { return(1) } else if (r == 'Rural' & d == 'Privado') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_infrad_school <- aggregate(AUTOADD ~ idschool, qd, mean)
m <- merge(mean_school, mean_infrad_school, by=c('idschool'))

ggplot(m, aes(x=AUTOADD,y=puntaje_estandar,color=rd)) + geom_point(alpha=0.7) + stat_smooth(method=lm,se=F) + scale_size(guide=FALSE) + xlab("Índice de autonomía administrativa de la escuela") + ylab("Puntaje Promedio por Escuela")
```
```{r puntaje_AUTOACD, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
# load sexto grado puntajes
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6 <- rbind.fill(pm6,pl6,pc6)
p6$promedio_global <- mean(p6$puntaje_estandar, na.rm=T)
p6$sd_global <- sd(p6$puntaje_estandar, na.rm=T)

p6 <- p6[p6$country == 'PAN',]

# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Publico","Privado")
levels(qd$ruralidad) <- c("Urbano","Rural")

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]
qf <- qf[,c("idschool","idstud","ISECF","INVOLUCF","CSOCBARF","SUPERVF","RECREAF","SERVBARF","VIOLBARF","MOTIVALF","subsgobf","padindig","madindig","DQFIT01","DQFIT25","DQFIT31","DQFIT34","DQFIT15_07","DQFIT18_02")]

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Privado') { return(0) } else if (r == 'Urbano' & d == 'Publico') { return(1) } else if (r == 'Rural' & d == 'Privado') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_infrad_school <- aggregate(AUTOACD ~ idschool, qd, mean)
m <- merge(mean_school, mean_infrad_school, by=c('idschool'))

ggplot(m, aes(x=AUTOACD,y=puntaje_estandar)) + geom_point(alpha=0.7) + stat_smooth(method=lm,se=F) + scale_size(guide=FALSE) + xlab("Índice de autonomía académica de la escuela") + ylab("Puntaje Promedio por Escuela")
```

```{r puntaje_AUTOACD_rd, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
# load sexto grado puntajes
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6 <- rbind.fill(pm6,pl6,pc6)
p6$promedio_global <- mean(p6$puntaje_estandar, na.rm=T)
p6$sd_global <- sd(p6$puntaje_estandar, na.rm=T)

p6 <- p6[p6$country == 'PAN',]

# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Publico","Privado")
levels(qd$ruralidad) <- c("Urbano","Rural")

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Privado') { return(0) } else if (r == 'Urbano' & d == 'Publico') { return(1) } else if (r == 'Rural' & d == 'Privado') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_infrad_school <- aggregate(AUTOACD ~ idschool, qd, mean)
m <- merge(mean_school, mean_infrad_school, by=c('idschool'))

ggplot(m, aes(x=AUTOACD,y=puntaje_estandar,color=rd)) + geom_point(alpha=0.7) + stat_smooth(method=lm,se=F) + scale_size(guide=FALSE) + xlab("Índice de autonomía académica de la escuela") + ylab("Puntaje Promedio por Escuela")
```

```{r puntaje_CLAMBLD, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
# load sexto grado puntajes
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6 <- rbind.fill(pm6,pl6,pc6)
p6$promedio_global <- mean(p6$puntaje_estandar, na.rm=T)
p6$sd_global <- sd(p6$puntaje_estandar, na.rm=T)

p6 <- p6[p6$country == 'PAN',]

# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Publico","Privado")
levels(qd$ruralidad) <- c("Urbano","Rural")

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]
qf <- qf[,c("idschool","idstud","ISECF","INVOLUCF","CSOCBARF","SUPERVF","RECREAF","SERVBARF","VIOLBARF","MOTIVALF","subsgobf","padindig","madindig","DQFIT01","DQFIT25","DQFIT31","DQFIT34","DQFIT15_07","DQFIT18_02")]

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Privado') { return(0) } else if (r == 'Urbano' & d == 'Publico') { return(1) } else if (r == 'Rural' & d == 'Privado') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_infrad_school <- aggregate(CLAMBLD ~ idschool, qd, mean)
m <- merge(mean_school, mean_infrad_school, by=c('idschool'))

ggplot(m, aes(x=CLAMBLD,y=puntaje_estandar)) + geom_point(alpha=0.7) + stat_smooth(method=lm,se=F) + scale_size(guide=FALSE) + xlab("Índice de calidad de ambiente laboral en la escuela (Director)") + ylab("Puntaje Promedio por Escuela")
```

```{r puntaje_CLAMBLD_rd, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
# load sexto grado puntajes
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6 <- rbind.fill(pm6,pl6,pc6)
p6$promedio_global <- mean(p6$puntaje_estandar, na.rm=T)
p6$sd_global <- sd(p6$puntaje_estandar, na.rm=T)

p6 <- p6[p6$country == 'PAN',]

# load factores alumnos
qd <- read.spss('./data/Directores/QD6.SAV', to.data.frame=T)
qd <- qd[qd$country == 'PAN',]

qd$dependencia <- as.factor(qd$dependencia)
qd$ruralidad <- as.factor(qd$ruralidad)
levels(qd$dependencia) <- c("Publico","Privado")
levels(qd$ruralidad) <- c("Urbano","Rural")

pe <- merge(p6,qd,by='idschool')
escuela_tipo <- function(r,d) { if(r == 'Urbano' & d == 'Privado') { return(0) } else if (r == 'Urbano' & d == 'Publico') { return(1) } else if (r == 'Rural' & d == 'Privado') {return(2)} else {return(3)}}
pe$rd <- as.factor(mapply(escuela_tipo, pe$ruralidad, pe$dependencia))
levels(pe$rd) <- c("Urbano/Particular", "Urbano/Oficial", "Rural/Particular", "Rural/Oficial")

mean_school <- aggregate(puntaje_estandar ~ idschool + rd + totalum , pe, mean)
mean_infrad_school <- aggregate(CLAMBLD ~ idschool, qd, mean)
m <- merge(mean_school, mean_infrad_school, by=c('idschool'))

ggplot(m, aes(x=CLAMBLD,y=puntaje_estandar,color=rd)) + geom_point(alpha=0.7) + stat_smooth(method=lm,se=F) + scale_size(guide=FALSE) + xlab("Índice de calidad de ambiente laboral en la escuela (Director)") + ylab("Puntaje Promedio por Escuela")
```

### Factores Asociados de Profesores

#### Indices

```{r echo=F,message=F,warning=F}
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
profmat6 <- read.spss('./data/Profesores/QP_M6.SAV', to.data.frame=T)

pm6 <- pm6[pm6$country == 'PAN',]
profmat6 <- profmat6[profmat6$country == 'PAN',]

pm6 <- pm6[,c("sID","puntaje_estandar","idschool","nivel")]
names(pm6) <- c("sID","puntaje_estandar","idschool","nivel")

pm6 <- merge(pm6,profmat6,by="idschool")

pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)
proflec6 <- read.spss('./data/Profesores/QP_L6.SAV', to.data.frame=T)

pl6 <- pl6[pl6$country == 'PAN',]
proflec6 <- proflec6[proflec6$country == 'PAN',]

pl6 <- pl6[,c("sID","puntaje_estandar","idschool","nivel")]
names(pl6) <- c("sID","puntaje_estandar","idschool","nivel")

pl6 <- merge(pl6,proflec6,by="idschool")


pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
profcien6 <- read.spss('./data/Profesores/QP_M6.SAV', to.data.frame=T)

pc6 <- pc6[pc6$country == 'PAN',]
profcien6 <- profcien6[profcien6$country == 'PAN',]

pc6 <- pc6[,c("sID","puntaje_estandar","idschool","nivel")]
names(pc6) <- c("sID","puntaje_estandar","idschool","nivel")

pc6 <- merge(pc6,profcien6,by="idschool")

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6prof <- rbind.fill(pm6,pl6,pc6)
```

```{r puntaje_prof_MOTIVP, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + MOTIVP, p6prof, mean)
ggplot(a, aes(x=MOTIVP,y=puntaje_estandar,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + xlab("Índice de actitudes, motivación docente") + ylab("") 
```
```{r puntaje_prof_CLAMBP, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + CLAMBP, p6prof, mean)
ggplot(a, aes(x=CLAMBP,y=puntaje_estandar,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + xlab("Índice de actitudes, motivación docente") + ylab("") 
```
```{r puntaje_prof_RELSALP, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + RELSALP, p6prof, mean)
ggplot(a, aes(x=RELSALP,y=puntaje_estandar,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + xlab("Índice de actitudes, motivación docente") + ylab("") 
```
```{r puntaje_prof_RELDIRP, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + RELDIRP, p6prof, mean)
ggplot(a, aes(x=RELDIRP,y=puntaje_estandar,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + xlab("Índice de actitudes, motivación docente") + ylab("") 
```
```{r puntaje_prof_VIOLENP, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + VIOLENP, p6prof, mean)
ggplot(a, aes(x=VIOLENP,y=puntaje_estandar,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + xlab("Índice de actitudes, motivación docente") + ylab("") 
```
```{r puntaje_prof_APOYOP, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + APOYOP, p6prof, mean)
ggplot(a, aes(x=APOYOP,y=puntaje_estandar,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + xlab("Índice de actitudes, motivación docente") + ylab("") 
```
```{r puntaje_prof_LIDERAP, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + LIDERAP, p6prof, mean)
ggplot(a, aes(x=LIDERAP,y=puntaje_estandar,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + xlab("Índice de actitudes, motivación docente") + ylab("") 
```
```{r puntaje_prof_MONITOP, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + MONITOP, p6prof, mean)
ggplot(a, aes(x=MONITOP,y=puntaje_estandar,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + xlab("Índice de actitudes, motivación docente") + ylab("") 
```

#### Datos de Profesores
```{r puntaje_prof_DQPIT01, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + DQPIT01, p6prof, mean)
ggplot(a, aes(x=DQPIT01,y=puntaje_estandar,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + xlab("Cual es su Edad?") + ylab("")
```

```{r puntaje_prof_DQPIT02, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT02 <- as.factor(p6prof$DQPIT02)
levels(p6prof$DQPIT02) <- c("Hombre","Mujer")
a <- aggregate(puntaje_estandar ~ DQPIT02 + tipo + DQPIT02, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT02)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Puntaje Promedio por Genero de Profesor')
```

```{r puntaje_prof_DQPIT03, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT03 <- as.factor(p6prof$DQPIT03)
levels(p6prof$DQPIT03) <- c("Castellano","Lengua Extranjera","Lengua Indigena 1","Lengua Indigena 2", "Otra Lengua")
a <- aggregate(puntaje_estandar ~ DQPIT03 + tipo + DQPIT03, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT03)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Puntaje Promedio por Genero de Profesor')
```

```{r puntaje_prof_DQPIT04, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + DQPIT04, p6prof, mean)
ggplot(a, aes(x=DQPIT04,y=puntaje_estandar,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + xlab(" ¿Hace cuantos años trabaja como docente?") + ylab("")
```

```{r puntaje_prof_DQPIT05, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
a <- aggregate(puntaje_estandar ~ idtealin + tipo + DQPIT05, p6prof, mean)
ggplot(a, aes(x=DQPIT05,y=puntaje_estandar,color=tipo)) + geom_point(alpha=0.7) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + xlab("") + ylab("")
```

```{r puntaje_prof_DQPIT07, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT07 <- as.factor(p6prof$DQPIT07)
levels(p6prof$DQPIT07) <- c("En la mañana","En la tarde","Jornada completa","Otra jornada")
a <- aggregate(puntaje_estandar ~ DQPIT07 + tipo + DQPIT07, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT07)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿En qué jornada asisten los estudiantes del aula evaluada?')
```

```{r puntaje_prof_DQPIT08, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT08 <- as.factor(p6prof$DQPIT08)
levels(p6prof$DQPIT08) <- c("Por tiempo indefinido","A plazo de 1yr","Menor a 1yr","Otro")
a <- aggregate(puntaje_estandar ~ DQPIT08 + tipo + DQPIT08, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT08)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Qué tipo de relación laboral tiene con este centro educativo?')
```

```{r puntaje_prof_DQPIT11, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT11 <- as.factor(p6prof$DQPIT11)
a <- aggregate(puntaje_estandar ~ DQPIT11 + tipo + DQPIT11, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT11)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Cuál es el nivel educativo más alto que usted ha completado?')
```

```{r puntaje_prof_DQPIT12_01, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT12_01 <- as.factor(p6prof$DQPIT12_01)
levels(p6prof$DQPIT12_01) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQPIT12_01 + tipo + DQPIT12_01, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT12_01)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Ha participado en alguna de las siguientes actividades..._He realizado un magíster')
```

```{r puntaje_prof_DQPIT12_02, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT12_02 <- as.factor(p6prof$DQPIT12_02)
levels(p6prof$DQPIT12_02) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQPIT12_02 + tipo + DQPIT12_02, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT12_02)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Ha participado en alguna de las siguientes actividades..._He realizado un diplomado')
```

```{r puntaje_prof_DQPIT12_07, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT12_07 <- as.factor(p6prof$DQPIT12_07)
levels(p6prof$DQPIT12_07) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQPIT12_07 + tipo + DQPIT12_07, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT12_07)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('No he realizado ninguna actividad de perfeccionamiento')
```

```{r puntaje_prof_DQPIT13, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT13 <- as.factor(p6prof$DQPIT13)
levels(p6prof$DQPIT13) <- c("Si, un mes", "Si, dos meses", "Si tres o mas meses", "No")
a <- aggregate(puntaje_estandar ~ DQPIT13 + tipo + DQPIT13, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT13)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿ha recibido usted alguna vez el apoyo y supervisión directa de un docente')
```

```{r puntaje_prof_DQPIT14, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
p6prof$DQPIT14 <- as.factor(p6prof$DQPIT14)
levels(p6prof$DQPIT14) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQPIT14 + tipo + DQPIT14, p6prof, mean)
a$dif <- (a$puntaje_estandar - mean(p6prof$puntaje_estandar,na.rm=T))/sd(p6prof$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=tipo,y=dif,fill=DQPIT14)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('No he realizado ninguna actividad de perfeccionamiento')
```

### Factores Asociados Familia

```{r echo=F,messages=F,warnings=F}
# load sexto grado puntajes
pm6 <- read.spss('./data/Puntajes_Alumnos/PM6_all_TERCE.sav', to.data.frame=T)
pc6 <- read.spss('./data/Puntajes_Alumnos/PC6_all_TERCE.sav', to.data.frame=T)
pl6 <- read.spss('./data/Puntajes_Alumnos/PL6_all_TERCE.sav', to.data.frame=T)

pm6 <- pm6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pl6 <- pl6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]
pc6 <- pc6[,c("sID","puntaje_estandar","nivel","idstud","country","idschool")]

# merge matematica, lectura y ciencias
pm6$tipo <- 'matematica'
pl6$tipo <- 'lectura'
pc6$tipo <- 'ciencias'
p6 <- rbind.fill(pm6,pl6,pc6)

p6 <- p6[p6$country == 'PAN',]

# load factores familia
qf <- read.spss('./data/Familia/QF6.SAV', to.data.frame=T)
qf <- qf[qf$country == 'PAN',]

pest <- merge(p6,qf,by='idstud')
```

#### Indices

```{r puntaje_familia_SUPERVF, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=SUPERVF,y=puntaje_estandar,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + xlab("Índice de control y supervisión de estudios en el hogar") + ylab("")
```
```{r puntaje_familia_MOTIVALF, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=MOTIVALF,y=puntaje_estandar,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + xlab("Índice de motivación de lectura en el hogar") + ylab("")
```
```{r puntaje_familia_RECREAF, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=RECREAF,y=puntaje_estandar,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + xlab("Índice de actividades recreativas con la familia") + ylab("")
```
```{r puntaje_familia_INVOLUCF, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=INVOLUCF,y=puntaje_estandar,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + xlab("Índice de involucramiento de los padres en la escuela") + ylab("")
```
```{r puntaje_familia_SERVBARF, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=SERVBARF,y=puntaje_estandar,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + xlab("Índice de servicios en el barrio") + ylab("")
```
```{r puntaje_familia_CSOCBARF, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=CSOCBARF,y=puntaje_estandar,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + xlab("Índice de apoyo social en el barrio") + ylab("")
```
```{r puntaje_familia_VIOLBARF, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
ggplot(pest, aes(x=VIOLBARF,y=puntaje_estandar,color=tipo)) + geom_point(alpha=0.2) + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = F) + xlab("Índice de violencia en el barrio") + ylab("")
```

#### Factores Asociados

```{r puntaje_familia_DQFIT01, fig.width=12, fig.height=10, echo=F, message=F, warning=F}
pest$DQFIT01 <- as.factor(pest$DQFIT01)
levels(pest$DQFIT01) <- c("Madre","Padre","Abuelo","Hermano","Pareja del padre/madre", "Otro Familiar","Apoderado/Tutor")
a <- aggregate(puntaje_estandar ~ DQFIT01, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT01,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Cuál es su relación con el niño/la niña que está participando en la evaluación?') + coord_flip()
```

Estos siguientes factores estan muy asociados al indice sociocultural.

```{r puntaje_familia_DQFIT15_01, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT15_01 <- as.factor(pest$DQFIT15_01)
levels(pest$DQFIT15_01) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQFIT15_01, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT15_01,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Cuenta con alguno de los siguientes servicios en su hogar?_Luz eléctrica')
```
```{r puntaje_familia_DQFIT15_02, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT15_02 <- as.factor(pest$DQFIT15_02)
levels(pest$DQFIT15_02) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQFIT15_02, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT15_02,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Cuenta con alguno de los siguientes servicios en su hogar?_Agua Potable')
```
```{r puntaje_familia_DQFIT15_03, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT15_03 <- as.factor(pest$DQFIT15_03)
levels(pest$DQFIT15_03) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQFIT15_03, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT15_03,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Cuenta con alguno de los siguientes servicios en su hogar?_Desague o Alcantarillado')
```
```{r puntaje_familia_DQFIT15_04, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT15_04 <- as.factor(pest$DQFIT15_04)
levels(pest$DQFIT15_04) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQFIT15_04, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT15_04,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Cuenta con alguno de los siguientes servicios en su hogar?_Recoleccion de Basura')
```
```{r puntaje_familia_DQFIT15_05, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT15_05 <- as.factor(pest$DQFIT15_05)
levels(pest$DQFIT15_05) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQFIT15_05, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT15_05,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Cuenta con alguno de los siguientes servicios en su hogar?_Telefono Fijo')
```
```{r puntaje_familia_DQFIT15_06, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT15_06 <- as.factor(pest$DQFIT15_06)
levels(pest$DQFIT15_06) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQFIT15_06, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT15_06,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Cuenta con alguno de los siguientes servicios en su hogar?_Television por Cable o Satelital')
```
```{r puntaje_familia_DQFIT15_07, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT15_07 <- as.factor(pest$DQFIT15_07)
levels(pest$DQFIT15_07) <- c("No","Si")
a <- aggregate(puntaje_estandar ~ DQFIT15_07, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT15_07,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('¿Cuenta con alguno de los siguientes servicios en su hogar?_Internet')
```


```{r puntaje_familia_DQFIT32_01, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT32_01 <- as.factor(pest$DQFIT32_01)
levels(pest$DQFIT32_01) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQFIT32_01, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT32_01,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Me aseguro que el estudiante haya hecho todas las tareas escolares')
```

```{r puntaje_familia_DQFIT32_02, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT32_02 <- as.factor(pest$DQFIT32_02)
levels(pest$DQFIT32_02) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQFIT32_02, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT32_02,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Le pregunto al estudiante qué hizo en la escuela')
```

```{r puntaje_familia_DQFIT32_03, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT32_03 <- as.factor(pest$DQFIT32_03)
levels(pest$DQFIT32_03) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQFIT32_03, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT32_03,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Le pregunto al estudiante qué notas ha obtenido en la escuela')
```

```{r puntaje_familia_DQFIT33_01, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT33_01 <- as.factor(pest$DQFIT33_01)
levels(pest$DQFIT33_01) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQFIT33_01, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT33_01,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Recibo informes con las notas del estudiante')
```

```{r puntaje_familia_DQFIT33_02, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT33_02 <- as.factor(pest$DQFIT33_02)
levels(pest$DQFIT33_02) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQFIT33_02, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT33_02,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Recibo informes o comunicaciones sobre la conducta')
```

```{r puntaje_familia_DQFIT33_03, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT33_03 <- as.factor(pest$DQFIT33_03)
levels(pest$DQFIT33_03) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQFIT33_03, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT33_03,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Recibo informes sobre el desempeño de la escuela en pruebas..')
```

```{r puntaje_familia_DQFIT33_04, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT33_04 <- as.factor(pest$DQFIT33_04)
levels(pest$DQFIT33_04) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQFIT33_04, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT33_04,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('Debo firmar las pruebas del estudiante')
```

```{r puntaje_familia_DQFIT33_05, fig.width=12, fig.height=5, echo=F, message=F, warning=F}
pest$DQFIT33_05 <- as.factor(pest$DQFIT33_05)
levels(pest$DQFIT33_05) <- c("Nunca o casi nunca","Algunas veces","Siempre o casi siempre")
a <- aggregate(puntaje_estandar ~ DQFIT33_05, pest, mean)
a$dif <- (a$puntaje_estandar - mean(pest$puntaje_estandar,na.rm=T))/sd(pest$puntaje_estandar,na.rm=T)
ggplot(a, aes(x=DQFIT33_05,y=dif)) + geom_bar(stat='identity',position='dodge') + xlab("") + ylab("") + ggtitle('De la escuela me citan para hablar sobre el estudiante')
```
